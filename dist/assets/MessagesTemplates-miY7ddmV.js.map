{"version":3,"file":"MessagesTemplates-miY7ddmV.js","sources":["../../src/pages/Templates/MessagesTemplates.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Box,\r\n  Tabs,\r\n  Tab,\r\n  Typography,\r\n  Button,\r\n  Paper,\r\n  Chip,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  Divider,\r\n  CircularProgress,\r\n} from \"@mui/material\";\r\nimport SaveIcon from \"@mui/icons-material/Save\";\r\nimport ContentCopyIcon from \"@mui/icons-material/ContentCopy\";\r\nimport RestoreIcon from \"@mui/icons-material/Restore\";\r\nimport ReactQuillWrapper from \"../../components/ReactQuillWrapper\";\r\nimport { notifySuccess, notifyError } from \"../../utilities/toastify\";\r\nimport Api, { handleApiError } from \"../../config/Api\";\r\n\r\nconst DefaultRepaymentDue = () => `\r\n  <p>عزيزي/عزيزتي {{اسم_العميل}}،</p>\r\n  <p>نود تذكيركم بأن قسطكم البالغ {{مبلغ_القسط}} ريال سيكون مستحق الدفع في {{تاريخ_الاستحقاق}}.</p>\r\n  <p>يرجى اتخاذ الإجراءات اللازمة لضمان السداد في الوقت المحدد.</p>\r\n  <p>شكراً لتعاونكم،</p>\r\n  <p>{{اسم_الشركة}}</p>\r\n`;\r\n\r\nconst DefaultRepaymentLate = () => `\r\n  <p>عزيزي/عزيزتي {{اسم_العميل}}،</p>\r\n  <p>نود إعلامكم بأن قسطكم البالغ {{مبلغ_القسط}} ريال والمستحق في {{تاريخ_الاستحقاق}} أصبح متأخراً.</p>\r\n  <p>الرجاء السداد في أقرب وقت ممكن لتجنب أي رسوم إضافية.</p>\r\n  <p>للاستفسار، يرجى التواصل معنا على {{رقم_الاتصال}}.</p>\r\n  <p>شكراً،</p>\r\n  <p>{{اسم_الشركة}}</p>\r\n`;\r\n\r\nconst DefaultPaymentApproved = () => `\r\n  <p>عزيزي/عزيزتي {{اسم_العميل}}،</p>\r\n  <p>نود إعلامكم بأن دفعتكم البالغة {{مبلغ_الدفعة}} ريال قد تمت الموافقة عليها بنجاح.</p>\r\n  <p>رقم المرجع: {{رقم_المرجع}}</p>\r\n  <p>تاريخ المعاملة: {{تاريخ_المعاملة}}</p>\r\n  <p>شكراً لتعاونكم،</p>\r\n  <p>{{اسم_الشركة}}</p>\r\n`;\r\n\r\nconst DefaultPaymentRejected = () => `\r\n  <p>عزيزي/عزيزتي {{اسم_العميل}}،</p>\r\n  <p>نأسف لإعلامكم بأن دفعتكم البالغة {{مبلغ_الدفعة}} ريال قد تم رفضها.</p>\r\n  <p>السبب: {{سبب_الرفض}}</p>\r\n  <p>يرجى التواصل معنا على {{رقم_الاتصال}} لمزيد من المعلومات.</p>\r\n  <p>شكراً،</p>\r\n  <p>{{اسم_الشركة}}</p>\r\n`;\r\n\r\nexport default function MessagesTemplates() {\r\n  const [activeTab, setActiveTab] = useState(\"repayment-due\");\r\n  const [templates, setTemplates] = useState({\r\n    repaymentDue: \"\",\r\n    repaymentLate: \"\",\r\n    paymentApproved: \"\",\r\n    paymentRejected: \"\",\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [variables, setVariables] = useState({\r\n    \"repayment-due\": [],\r\n    \"repayment-late\": [],\r\n    \"payment-approved\": [],\r\n    \"payment-rejected\": [],\r\n  });\r\n\r\n  const templateNameMap = React.useMemo(() => ({\r\n    \"repayment-due\": \"REPAYMENT_DUE\",\r\n    \"repayment-late\": \"REPAYMENT_LATE\", \r\n    \"payment-approved\": \"PAYMENT_APPROVED\",\r\n    \"payment-rejected\": \"PAYMENT_REJECTED\",\r\n  }), []);\r\n\r\n  \r\n\r\n  const getDefaultTemplate = React.useCallback((templateName) => {\r\n    switch (templateName) {\r\n      case \"REPAYMENT_DUE\":\r\n        return DefaultRepaymentDue();\r\n      case \"REPAYMENT_LATE\":\r\n        return DefaultRepaymentLate();\r\n      case \"PAYMENT_APPROVED\":\r\n        return DefaultPaymentApproved();\r\n      case \"PAYMENT_REJECTED\":\r\n        return DefaultPaymentRejected();\r\n      default:\r\n        return \"\";\r\n    }\r\n  }, []);\r\n\r\n  const extractVariablesFromContent = (content) => {\r\n    const variableRegex = /{{(.*?)}}/g;\r\n    const matches = content.match(variableRegex) || [];\r\n    const uniqueVariables = [...new Set(matches)];\r\n    \r\n    return uniqueVariables.map(variable => ({\r\n      name: variable,\r\n      description: getVariableDescription(variable)\r\n    }));\r\n  };\r\n\r\n  const getVariableDescription = (variable) => {\r\n    const variableDescriptions = {\r\n      \"{{اسم_العميل}}\": \"اسم العميل\",\r\n      \"{{اسم_الشركة}}\": \"اسم الشركة أو المؤسسة\",\r\n      \"{{رقم_الاتصال}}\": \"رقم الاتصال أو خدمة العملاء\",\r\n      \"{{البريد_الإلكتروني}}\": \"البريد الإلكتروني للشركة\",\r\n      \"{{الموقع_الإلكتروني}}\": \"الموقع الإلكتروني للشركة\",\r\n      \"{{مبلغ_القسط}}\": \"مبلغ القسط المستحق\",\r\n      \"{{تاريخ_الاستحقاق}}\": \"تاريخ استحقاق القسط\",\r\n      \"{{مبلغ_الدفعة}}\": \"مبلغ الدفعة المقدمة\",\r\n      \"{{رقم_المرجع}}\": \"رقم المرجع أو المعاملة\",\r\n      \"{{تاريخ_المعاملة}}\": \"تاريخ إتمام المعاملة\",\r\n      \"{{سبب_الرفض}}\": \"سبب رفض الدفعة\",\r\n      \"{{رقم_العقد}}\": \"رقم العقد\",\r\n      \"{{رقم_القسط}}\": \"رقم القسط\",\r\n      \"{{المبلغ_المتبقي}}\": \"المبلغ المتبقي للدفع\",\r\n      \"{{عدد_أيام_التأخير}}\": \"عدد أيام التأخير\",\r\n      \"{{الغرامات_المستحقة}}\": \"قيمة الغرامات المستحقة\",\r\n      \"{{آخر_موعد_للدفع}}\": \"آخر موعد للدفع بدون غرامات\",\r\n    };\r\n\r\n    return variableDescriptions[variable] || `متغير: ${variable.replace(/[{}]/g, '')}`;\r\n  };\r\n\r\n  const fetchTemplateFromAPI = React.useCallback(async (templateName) => {\r\n    try {\r\n      const response = await Api.get(`/api/templates/${templateName}`);\r\n      if (response.data.content && response.data.content.trim() !== \"\") {\r\n        return response.data.content;\r\n      } else {\r\n        console.log(`Template ${templateName} found in API but empty, using frontend default`);\r\n        return getDefaultTemplate(templateName);\r\n      }\r\n    } catch {\r\n      console.log(`Template ${templateName} not found in API, using frontend default`);\r\n      return getDefaultTemplate(templateName);\r\n    }\r\n  }, [getDefaultTemplate]);\r\n\r\n  const copyToClipboard = (text) => {\r\n    navigator.clipboard.writeText(text).then(() => {\r\n      notifySuccess('تم نسخ المتغير:', text);\r\n    });\r\n  };\r\n\r\n  const loadTemplates = React.useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const templatePromises = Object.keys(templateNameMap).map(async (key) => {\r\n        const templateName = templateNameMap[key];\r\n        const content = await fetchTemplateFromAPI(templateName);\r\n        return { key, content };\r\n      });\r\n\r\n      const results = await Promise.all(templatePromises);\r\n      const newTemplates = {};\r\n      const newVariables = { ...variables };\r\n      \r\n      results.forEach(({ key, content }) => {\r\n\r\n        const stateKey = key === \"repayment-due\" ? \"repaymentDue\" :\r\n                        key === \"repayment-late\" ? \"repaymentLate\" :\r\n                        key === \"payment-approved\" ? \"paymentApproved\" :\r\n                        key === \"payment-rejected\" ? \"paymentRejected\" :\r\n                        key;\r\n        newTemplates[stateKey] = content;\r\n        \r\n        newVariables[key] = extractVariablesFromContent(content);\r\n      });\r\n\r\n      setTemplates(newTemplates);\r\n      setVariables(newVariables);\r\n    } catch (error) {\r\n      notifyError(\"خطأ في تحميل القوالب\");\r\n      handleApiError(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [templateNameMap, fetchTemplateFromAPI]);\r\n\r\n  const VariablesList = ({ variables }) => (\r\n    <Card sx={{ mb: 3, border: '1px solid #e5e7eb' }}>\r\n      <CardContent>\r\n        <Box sx={{ display: \"flex\", justifyContent: \"space-between\", mt: 3 }}>\r\n          <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 'bold', color: '#2d3748' }}>\r\n            المتغيرات المتاحة\r\n          </Typography>\r\n          <Box sx={{ display: 'flex', gap: 2 }}>\r\n            <Button\r\n              variant=\"outlined\"\r\n              color=\"secondary\"\r\n              startIcon={<RestoreIcon sx={{marginLeft:'10px'}} />}\r\n              sx={{ \r\n                px: 3, \r\n                py: 1.2, \r\n                mt: 2, \r\n                fontWeight: \"bold\",\r\n                borderRadius: '10px',\r\n                '&:hover': {\r\n                  backgroundColor: '#f5f5f5'\r\n                }\r\n              }}\r\n              onClick={handleResetToDefault}\r\n            >\r\n              إعادة تعيين افتراضي\r\n            </Button>\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              startIcon={saving ? <CircularProgress size={16} color=\"inherit\" /> : <SaveIcon sx={{marginLeft:'10px'}} />}\r\n              disabled={saving}\r\n              sx={{ \r\n                px: 4, \r\n                py: 1.2, \r\n                mt: 2, \r\n                fontWeight: \"bold\",\r\n                borderRadius: '10px',\r\n                '&:hover': {\r\n                  backgroundColor: '#1565c0'\r\n                }\r\n              }}\r\n              onClick={handleSave}\r\n            >\r\n              {saving ? 'جاري الحفظ...' : 'حفظ التغييرات'}\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n        <Typography variant=\"body2\" sx={{ mb: 2, color: '#666' }}>\r\n          انقر على أي متغير لنسخه واستخدامه في القالب\r\n        </Typography>\r\n        <Divider sx={{ mb: 2 }} />\r\n        <Grid container spacing={1}>\r\n          {variables.map((variable, index) => (\r\n            <Grid item xs={12} sm={6} md={4} key={index}>\r\n              <Chip\r\n                label={variable.name}\r\n                onClick={() => copyToClipboard(variable.name)}\r\n                icon={<ContentCopyIcon sx={{ fontSize: '16px !important' }} />}\r\n                sx={{\r\n                  width: '100%',\r\n                  justifyContent: 'flex-start',\r\n                  mb: 1,\r\n                  px: 1,\r\n                  py: 2,\r\n                  height: 'auto',\r\n                  minHeight: '40px',\r\n                  backgroundColor: '#f8f9fc',\r\n                  border: '1px solid #e5e7eb',\r\n                  '&:hover': {\r\n                    backgroundColor: '#e0e7ff',\r\n                    borderColor: '#3b82f6',\r\n                  },\r\n                  '& .MuiChip-label': {\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    whiteSpace: 'normal',\r\n                    textAlign: 'right',\r\n                    direction: 'rtl',\r\n                  }\r\n                }}\r\n                title={variable.description}\r\n              />\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  useEffect(() => {\r\n    loadTemplates();\r\n  }, [loadTemplates]);\r\n\r\n  const handleSave = async () => {\r\n    setSaving(true);\r\n    try {\r\n      const currentTemplateKey = activeTab;\r\n      const templateName = templateNameMap[currentTemplateKey];\r\n      \r\n      const stateKey = currentTemplateKey === \"repayment-due\" ? \"repaymentDue\" :\r\n                      currentTemplateKey === \"repayment-late\" ? \"repaymentLate\" :\r\n                      currentTemplateKey === \"payment-approved\" ? \"paymentApproved\" :\r\n                      currentTemplateKey === \"payment-rejected\" ? \"paymentRejected\" :\r\n                      currentTemplateKey;\r\n      \r\n      const templateContent = templates[stateKey];\r\n\r\n      await Api.post(\"/api/templates\", {\r\n        name: templateName,\r\n        description: `Template for ${templateName} messages`,\r\n        content: templateContent,\r\n      });\r\n      \r\n      notifySuccess(\"تم حفظ القالب بنجاح\");\r\n    } catch (error) {\r\n      notifyError(\"خطأ في حفظ القالب\");\r\n      handleApiError(error);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleTemplateChange = (templateKey, value) => {\r\n    setTemplates(prev => ({\r\n      ...prev,\r\n      [templateKey]: value\r\n    }));\r\n\r\n    const tabKey = templateKey === \"repaymentDue\" ? \"repayment-due\" :\r\n                   templateKey === \"repaymentLate\" ? \"repayment-late\" :\r\n                   templateKey === \"paymentApproved\" ? \"payment-approved\" :\r\n                   templateKey === \"paymentRejected\" ? \"payment-rejected\" :\r\n                   templateKey;\r\n    \r\n    setVariables(prev => ({\r\n      ...prev,\r\n      [tabKey]: extractVariablesFromContent(value)\r\n    }));\r\n  };\r\n\r\n  const handleResetToDefault = () => {\r\n    const currentTemplateKey = activeTab;\r\n    const templateName = templateNameMap[currentTemplateKey];\r\n    const defaultContent = getDefaultTemplate(templateName);\r\n    \r\n    const stateKey = currentTemplateKey === \"repayment-due\" ? \"repaymentDue\" :\r\n                    currentTemplateKey === \"repayment-late\" ? \"repaymentLate\" :\r\n                    currentTemplateKey === \"payment-approved\" ? \"paymentApproved\" :\r\n                    currentTemplateKey === \"payment-rejected\" ? \"paymentRejected\" :\r\n                    currentTemplateKey;\r\n    \r\n    setTemplates(prev => ({\r\n      ...prev,\r\n      [stateKey]: defaultContent\r\n    }));\r\n\r\n    setVariables(prev => ({\r\n      ...prev,\r\n      [currentTemplateKey]: extractVariablesFromContent(defaultContent)\r\n    }));\r\n    \r\n    notifySuccess(\"تم إعادة تعيين القالب إلى النسخة الافتراضية\");\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ display: \"flex\", height: \"100vh\" }}>\r\n      <Box sx={{ flex: 1, display: \"flex\", flexDirection: \"column\" }}>\r\n        <Box sx={{ p: 4, overflowY: \"auto\", flex: 1 }}>\r\n          <Paper sx={{ p: 3, borderRadius: 2 }}>\r\n            <Tabs\r\n              value={activeTab}\r\n              onChange={(e, val) => setActiveTab(val)}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              textColor=\"primary\"\r\n              indicatorColor=\"primary\"\r\n              sx={{\r\n                borderBottom: \"1px solid #e5e7eb\",\r\n                mb: 3,\r\n                \"& .MuiTab-root\": { \r\n                  fontWeight: \"bold\", \r\n                  fontSize: \"0.9rem\",\r\n                  minWidth: \"auto\",\r\n                  px: 2\r\n                },\r\n              }}\r\n            >\r\n              <Tab label=\"تذكير استحقاق قسط\" value=\"repayment-due\" />\r\n              <Tab label=\"تذكير تأخير سداد\" value=\"repayment-late\" />\r\n              <Tab label=\"موافقة على دفعة\" value=\"payment-approved\" />\r\n              <Tab label=\"رفض دفعة\" value=\"payment-rejected\" />\r\n            </Tabs>\r\n\r\n            <Box sx={{ mt: 3 }}>\r\n              {loading ? (\r\n                <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '400px' }}>\r\n                  <CircularProgress size={40} />\r\n                  <Typography sx={{ ml: 2 }}>جاري تحميل القوالب...</Typography>\r\n                </Box>\r\n              ) : (\r\n                <>\r\n                  {activeTab === \"repayment-due\" && (\r\n                    <>\r\n                      <VariablesList variables={variables[\"repayment-due\"]} />\r\n                      <ReactQuillWrapper\r\n                        theme=\"snow\"\r\n                        value={templates.repaymentDue}\r\n                        onChange={(value) => handleTemplateChange(\"repaymentDue\", value)}\r\n                        placeholder=\"أدخل نص قالب تذكير استحقاق القسط هنا...\"\r\n                        style={{ height: \"500px\", marginBottom: \"40px\" }}\r\n                      />\r\n                    </>\r\n                  )}\r\n                  {activeTab === \"repayment-late\" && (\r\n                    <>\r\n                      <VariablesList variables={variables[\"repayment-late\"]} />\r\n                      <ReactQuillWrapper\r\n                        theme=\"snow\"\r\n                        value={templates.repaymentLate}\r\n                        onChange={(value) => handleTemplateChange(\"repaymentLate\", value)}\r\n                        placeholder=\"أدخل نص قالب تذكير تأخير السداد هنا...\"\r\n                        style={{ height: \"500px\", marginBottom: \"40px\" }}\r\n                      />\r\n                    </>\r\n                  )}\r\n                  {activeTab === \"payment-approved\" && (\r\n                    <>\r\n                      <VariablesList variables={variables[\"payment-approved\"]} />\r\n                      <ReactQuillWrapper\r\n                        theme=\"snow\"\r\n                        value={templates.paymentApproved}\r\n                        onChange={(value) => handleTemplateChange(\"paymentApproved\", value)}\r\n                        placeholder=\"أدخل نص قالب موافقة على الدفعة هنا...\"\r\n                        style={{ height: \"500px\", marginBottom: \"40px\" }}\r\n                      />\r\n                    </>\r\n                  )}\r\n                  {activeTab === \"payment-rejected\" && (\r\n                    <>\r\n                      <VariablesList variables={variables[\"payment-rejected\"]} />\r\n                      <ReactQuillWrapper\r\n                        theme=\"snow\"\r\n                        value={templates.paymentRejected}\r\n                        onChange={(value) => handleTemplateChange(\"paymentRejected\", value)}\r\n                        placeholder=\"أدخل نص قالب رفض الدفعة هنا...\"\r\n                        style={{ height: \"500px\", marginBottom: \"40px\" }}\r\n                      />\r\n                    </>\r\n                  )}\r\n                </>\r\n              )}\r\n            </Box>\r\n          </Paper>\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}"],"names":["DefaultRepaymentDue","DefaultRepaymentLate","DefaultPaymentApproved","DefaultPaymentRejected","MessagesTemplates","activeTab","setActiveTab","useState","templates","setTemplates","loading","setLoading","saving","setSaving","variables","setVariables","templateNameMap","React","getDefaultTemplate","templateName","extractVariablesFromContent","content","variableRegex","matches","variable","getVariableDescription","fetchTemplateFromAPI","response","Api","copyToClipboard","text","notifySuccess","loadTemplates","templatePromises","key","results","newTemplates","newVariables","stateKey","error","notifyError","handleApiError","VariablesList","jsx","Card","CardContent","jsxs","Box","Typography","Button","RestoreIcon","handleResetToDefault","CircularProgress","SaveIcon","handleSave","Divider","Grid","index","Chip","ContentCopyIcon","useEffect","currentTemplateKey","templateContent","handleTemplateChange","templateKey","value","prev","tabKey","defaultContent","Paper","Tabs","val","Tab","Fragment","ReactQuillWrapper"],"mappings":"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"}