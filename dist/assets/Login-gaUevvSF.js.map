{"version":3,"file":"Login-gaUevvSF.js","sources":["../../src/pages/auth/Login.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport {\r\n  Box,\r\n  Card,\r\n  CardContent,\r\n  TextField,\r\n  Button,\r\n  Typography,\r\n  CircularProgress,\r\n  InputAdornment,\r\n  IconButton,\r\n} from \"@mui/material\";\r\nimport {\r\n  MdAccountBalance as AccountBalance,\r\n  MdVisibility as VisibilityIcon,\r\n  MdVisibilityOff as VisibilityOffIcon,\r\n} from \"react-icons/md\";\r\n\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { Formik, Form } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nimport Api, { handleApiError } from \"../../config/Api\";\r\nimport { notifySuccess, notifyError } from \"../../utilities/toastify\";\r\n\r\nconst validationSchema = Yup.object().shape({\r\n  email: Yup.string()\r\n    .trim()\r\n    .email(\"البريد الإلكتروني غير صالح\")\r\n    .required(\"البريد الإلكتروني مطلوب\"),\r\n  password: Yup.string().trim().required(\"كلمة المرور مطلوبة\"),\r\n});\r\n\r\nconst Login = () => {\r\n  const navigate = useNavigate();\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const handleTogglePassword = () => setShowPassword(!showPassword);\r\n\r\n  const handleSubmit = async (values) => {\r\n    setIsLoading(true);\r\n    try {\r\n      const cleanedValues = {\r\n        ...values,\r\n        email: values.email.trim(),\r\n      };\r\n\r\n      const response = await Api.post(\"/api/auth/login\", cleanedValues);\r\n      const { accessToken, user, role } = response.data;\r\n\r\n      // تخزين البيانات في localStorage\r\n      localStorage.setItem(\"token\", accessToken);\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n      if (role?.permissions) {\r\n        localStorage.setItem(\"permissions\", JSON.stringify(role.permissions));\r\n      }\r\n\r\n      notifySuccess(\"تم تسجيل الدخول بنجاح\");\r\n\r\n      // توجيه المستخدم للوحة التحكم\r\n      navigate(\"/dashboard\", { replace: true });\r\n    } catch (error) {\r\n      notifyError(\"خطأ في تسجيل الدخول\");\r\n      handleApiError(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        minHeight: \"100vh\",\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n        background: \"linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%)\",\r\n        padding: 2,\r\n      }}\r\n    >\r\n      <Helmet>\r\n        <title>تسجيل الدخول</title>\r\n        <meta name=\"description\" content=\"تسجيل الدخول لنظام إدارة السلف\" />\r\n      </Helmet>\r\n\r\n      <Card\r\n        sx={{\r\n          maxWidth: 450,\r\n          width: \"100%\",\r\n          boxShadow: \"0 8px 32px rgba(0,0,0,0.1)\",\r\n          borderRadius: 3,\r\n        }}\r\n      >\r\n        <CardContent sx={{ p: 4 }}>\r\n          <Box sx={{ textAlign: \"center\", mb: 4 }}>\r\n            <AccountBalance\r\n              style={{\r\n                fontSize: 40,\r\n                color: \"#1976d2\",\r\n                marginBottom: 10,\r\n              }}\r\n            />\r\n            <Typography\r\n              gutterBottom\r\n              sx={{\r\n                fontSize: 24,\r\n                fontWeight: 600,\r\n                color: \"#1976d2\",\r\n              }}\r\n            >\r\n              نظام إدارة السلف\r\n            </Typography>\r\n          </Box>\r\n\r\n          <Formik\r\n            initialValues={{\r\n              email: \"\",\r\n              password: \"\",\r\n            }}\r\n            validationSchema={validationSchema}\r\n            onSubmit={handleSubmit}\r\n          >\r\n            {({\r\n              values,\r\n              errors,\r\n              touched,\r\n              handleChange,\r\n              handleBlur,\r\n              handleSubmit,\r\n            }) => (\r\n              <Form onSubmit={handleSubmit}>\r\n                <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 3 }}>\r\n                  {/* البريد الإلكتروني */}\r\n                  <TextField\r\n                    fullWidth\r\n                    label=\"البريد الإلكتروني\"\r\n                    name=\"email\"\r\n                    value={values.email}\r\n                    onChange={handleChange}\r\n                    onBlur={handleBlur}\r\n                    error={touched.email && Boolean(errors.email)}\r\n                    helperText={touched.email && errors.email}\r\n                    variant=\"outlined\"\r\n                    InputLabelProps={{ shrink: true }}\r\n                    autoComplete=\"username\"\r\n                    disabled={isLoading}\r\n                  />\r\n\r\n                  {/* كلمة المرور */}\r\n                  <TextField\r\n                    fullWidth\r\n                    label=\"كلمة المرور\"\r\n                    name=\"password\"\r\n                    type={showPassword ? \"text\" : \"password\"}\r\n                    value={values.password}\r\n                    onChange={handleChange}\r\n                    onBlur={handleBlur}\r\n                    error={touched.password && Boolean(errors.password)}\r\n                    helperText={touched.password && errors.password}\r\n                    variant=\"outlined\"\r\n                    autoComplete=\"current-password\"\r\n                    disabled={isLoading}\r\n                    InputLabelProps={{ shrink: true }}\r\n                    InputProps={{\r\n                      endAdornment: (\r\n                        <InputAdornment position=\"end\" sx={{ shrink: true }}>\r\n                          <IconButton onClick={handleTogglePassword}>\r\n                            {showPassword ? (\r\n                              <VisibilityOffIcon size={20} />\r\n                            ) : (\r\n                              <VisibilityIcon size={20} />\r\n                            )}\r\n                          </IconButton>\r\n                        </InputAdornment>\r\n                      ),\r\n                    }}\r\n                  />\r\n\r\n                  <Button\r\n                    type=\"submit\"\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    disabled={isLoading}\r\n                    sx={{\r\n                      py: 1.5,\r\n                      fontWeight: 500,\r\n                      fontSize: \"1rem\",\r\n                    }}\r\n                  >\r\n                    {isLoading ? (\r\n                      <CircularProgress size={24} sx={{ color: \"#fff\" }} />\r\n                    ) : (\r\n                      \"تسجيل الدخول\"\r\n                    )}\r\n                  </Button>\r\n                </Box>\r\n              </Form>\r\n            )}\r\n          </Formik>\r\n        </CardContent>\r\n      </Card>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"names":["validationSchema","Yup.object","Yup.string","Login","navigate","useNavigate","showPassword","setShowPassword","useState","isLoading","setIsLoading","handleTogglePassword","handleSubmit","values","cleanedValues","response","Api","accessToken","user","role","notifySuccess","error","notifyError","handleApiError","jsxs","Box","Helmet","jsx","Card","CardContent","AccountBalance","Typography","Formik","errors","touched","handleChange","handleBlur","Form","TextField","InputAdornment","IconButton","VisibilityOffIcon","VisibilityIcon","Button","CircularProgress"],"mappings":"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"}