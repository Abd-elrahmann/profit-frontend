import{q as A,j as e,r as w,B as o,Y as i,am as v,an as C,aK as R,aL as S,ao as f,a6 as b,k as L,_ as W,H as F,$ as I,a0 as k,a1 as $,a2 as H,a3 as D,a4 as n,a5 as O,l as U,T as z}from"./index-Byloyp0V.js";import{g as B}from"./logsApi-MFzB1Yn4.js";import{D as M}from"./DatePicker-Cl157OL-.js";import{T as N}from"./TablePagination-rGYbANAk.js";import"./Popper-Rekw_xHk.js";import"./KeyboardArrowRight-nGgaUmNE.js";import"./LastPage-D5DKCjzm.js";const q=A(e.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"})),J=A(e.jsx("path",{d:"M6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91m14 0c0-4.42-3.58-8-8-8-.06 0-.12.01-.18.01l1.09-1.09L11.5 2.5 8 6l3.5 3.5 1.41-1.41-1.08-1.08c.06 0 .12-.01.17-.01 3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93"})),K=({filters:h,onFilterChange:l,onResetFilters:m})=>{const{search:u,screen:r,action:x,from:c,to:d,userName:j}=h,g=w.useRef(null),T=a=>{l("action",a.target.value)},y=a=>{l("screen",a.target.value)},s=a=>{l("from",a?a.format("YYYY-MM-DD"):"")},t=a=>{l("to",a?a.format("YYYY-MM-DD"):"")},p=()=>{g.current&&(g.current.value=""),m()},Y=u||r||x||c||d||j,P=[{value:"Auth",label:"المصادقة"},{value:"Bank Accounts",label:"الحسابات البنكية"},{value:"Clients",label:"العملاء"},{value:"Journals",label:"القيود"},{value:"Loans",label:"السلف"},{value:"Partners",label:"الشركاء"},{value:"Repayments",label:"الأقساط"},{value:"Roles",label:"الأدوار"},{value:"Templates",label:"القوالب"},{value:"Users",label:"المستخدمين"}],E=[{value:"CREATE",label:"إنشاء"},{value:"UPDATE",label:"تعديل"},{value:"DELETE",label:"حذف"},{value:"VIEW",label:"عرض"},{value:"login",label:"تسجيل دخول"},{value:"logout",label:"تسجيل خروج"}];return e.jsxs(o,{sx:{p:3,bgcolor:"background.paper",borderRadius:2,border:"1px solid",borderColor:"divider",mb:3},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(q,{color:"primary"}),e.jsx(o,{sx:{fontWeight:"bold",fontSize:"1.1rem"},children:"فلترة السجلات"})]}),Y&&e.jsx(i,{label:"بحث مفعل",color:"primary",variant:"outlined",size:"small"})]}),e.jsxs(v,{direction:{xs:"column",md:"row"},spacing:2,alignItems:{xs:"stretch",md:"center"},justifyContent:"space-between",children:[e.jsxs(v,{direction:"row",spacing:4,alignItems:"center",sx:{flex:1},children:[e.jsxs(C,{sx:{minWidth:150},size:"small",children:[e.jsx(R,{shrink:!0,children:"نوع الإجراء"}),e.jsxs(S,{value:x||"",onChange:T,label:"نوع الإجراء",notched:!0,children:[e.jsx(f,{value:"",children:"كل الإجراءات"}),E.map(a=>e.jsx(f,{value:a.value,children:a.label},a.value))]})]}),e.jsxs(C,{sx:{minWidth:150},size:"small",children:[e.jsx(R,{shrink:!0,children:"الشاشة"}),e.jsxs(S,{value:r||"",onChange:y,label:"الشاشة",notched:!0,children:[e.jsx(f,{value:"",children:"كل الشاشات"}),P.map(a=>e.jsx(f,{value:a.value,children:a.label},a.value))]})]})]}),e.jsxs(v,{direction:"row",spacing:2,alignItems:"center",sx:{flex:1,justifyContent:"center"},children:[e.jsx(M,{label:"من تاريخ",value:c?b(c):null,onChange:s,slotProps:{textField:{size:"small",sx:{width:"250px"}}},format:"DD/MM/YYYY"}),e.jsx(M,{label:"إلى تاريخ",value:d?b(d):null,onChange:t,slotProps:{textField:{size:"small",sx:{width:"250px"}}},format:"DD/MM/YYYY"})]}),e.jsx(o,{sx:{display:"flex",justifyContent:"flex-end"},children:Y&&e.jsx(L,{variant:"outlined",startIcon:e.jsx(J,{}),onClick:p,color:"inherit",size:"small",children:"إعادة تعيين"})})]}),Y&&e.jsx(o,{sx:{mt:2,p:1.5,bgcolor:"grey.50",borderRadius:1},children:e.jsxs(v,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[u&&e.jsx(i,{label:`بحث: ${u}`,size:"small",onDelete:()=>l("search",""),variant:"outlined"}),j&&e.jsx(i,{label:`مستخدم: ${j}`,size:"small",onDelete:()=>l("userName",""),variant:"outlined"}),x&&e.jsx(i,{label:`إجراء: ${E.find(a=>a.value===x)?.label}`,size:"small",onDelete:()=>l("action",""),variant:"outlined"}),r&&e.jsx(i,{label:`شاشة: ${P.find(a=>a.value===r)?.label}`,size:"small",onDelete:()=>l("screen",""),variant:"outlined"}),c&&e.jsx(i,{label:`من: ${b(c).format("DD/MM/YYYY")}`,size:"small",onDelete:()=>l("from",""),variant:"outlined"}),d&&e.jsx(i,{label:`إلى: ${b(d).format("DD/MM/YYYY")}`,size:"small",onDelete:()=>l("to",""),variant:"outlined"})]})})]})},se=()=>{const[h,l]=w.useState(1),[m,u]=w.useState({search:"",screen:"",action:"",from:"",to:"",userName:""}),{data:r,isLoading:x}=W({queryKey:["allLogs",h,m],queryFn:()=>B(h,m)}),c=(s,t)=>{u(p=>({...p,[s]:t})),l(1)},d=()=>{u({search:"",screen:"",action:"",from:"",to:"",userName:""}),l(1)},j=(s,t)=>{l(t+1)},g=s=>{switch(s){case"CREATE":return"إنشاء";case"UPDATE":return"تعديل";case"DELETE":return"حذف";case"VIEW":return"عرض";case"POST":return"اعتماد";case"UNPOST":return"إلغاء الاعتماد";case"login":return"تسجيل دخول";case"logout":return"تسجيل خروج";default:return s}},T=s=>{switch(s){case"CREATE":return"success";case"UPDATE":return"warning";case"DELETE":return"error";case"VIEW":return"info";case"POST":return"success";case"UNPOST":return"error";case"login":return"primary";case"logout":return"secondary";default:return"default"}},y=s=>({Auth:"المصادقة","Bank Accounts":"الحسابات البنكية",Clients:"العملاء",Journals:"القيود اليومية",Loans:"السلف",Partners:"المستثمرين",Repayments:"الأقساط",Roles:"الأدوار",Templates:"القوالب",Users:"المستخدمين"})[s]||s;return e.jsxs(o,{sx:{bgcolor:"#FFFFFF",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsxs(F,{children:[e.jsx("title",{children:"سجلات النشاطات"}),e.jsx("meta",{name:"description",content:"سجلات النشاطات"})]}),e.jsxs(o,{sx:{p:5},children:[e.jsx(K,{filters:m,onFilterChange:c,onResetFilters:d}),e.jsxs(I,{sx:{width:"100%",overflow:"hidden",borderRadius:2},children:[e.jsx(k,{children:e.jsxs($,{stickyHeader:!0,children:[e.jsx(H,{sx:{bgcolor:"#F3F4F6"},children:e.jsxs(D,{children:[e.jsx(n,{align:"center",sx:{fontWeight:"bold"},children:"المستخدم"}),e.jsx(n,{align:"center",sx:{fontWeight:"bold"},children:"الشاشة"}),e.jsx(n,{align:"center",sx:{fontWeight:"bold"},children:"الإجراء"}),e.jsx(n,{align:"center",sx:{fontWeight:"bold"},children:"الوصف"}),e.jsx(n,{align:"center",sx:{fontWeight:"bold"},children:"التاريخ والوقت"})]})}),e.jsx(O,{children:x?e.jsx(D,{children:e.jsx(n,{colSpan:5,align:"center",children:e.jsx(U,{size:20})})}):r?.data?.length===0?e.jsx(D,{children:e.jsx(n,{colSpan:5,align:"center",children:e.jsx(z,{children:"لا توجد سجلات أنشطة"})})}):r?.data?.map(s=>e.jsxs(D,{hover:!0,children:[e.jsx(n,{align:"center",sx:{whiteSpace:"nowrap",fontWeight:"bold"},children:s.user.name}),e.jsx(n,{align:"center",sx:{whiteSpace:"nowrap"},children:y(s.screen)}),e.jsx(n,{align:"center",sx:{whiteSpace:"nowrap"},children:e.jsx(i,{label:g(s.action),color:T(s.action),size:"small"})}),e.jsx(n,{align:"center",style:{wordWrap:"break-word",maxWidth:"170px"},children:e.jsx(z,{variant:"body2",children:s.description})}),e.jsx(n,{align:"center",sx:{whiteSpace:"nowrap"},children:b(s.createdAt).format("DD/MM/YYYY HH:mm a")})]},s.id))})]})}),r&&e.jsx(N,{component:"div",count:r.total||0,page:h-1,onPageChange:j,rowsPerPage:10,rowsPerPageOptions:[10],labelDisplayedRows:({from:s,to:t,count:p})=>`عرض ${s}-${t} من ${p}`,labelRowsPerPage:"صفوف لكل صفحة:"})]})]})]})};export{se as default};
//# sourceMappingURL=logs-Cg-ru0kn.js.map
