import{f as nn,j as e,r as d,ag as un,ac as Et,ah as Pt,ai as fn,k as on,i as rn,l as an,s as be,t as vt,v as $t,w as sn,m as at,aj as gn,ak as hn,q as Rt,P as gt,V as zt,al as ut,am as rt,an as Kt,ao as Ft,I as Mt,A as me,h as $e,G as ln,K as At,B as _,ap as xn,L as mn,N as bn,O as yn,Q as Dt,R as O,U as In,C as Lt,T as te,W as wn,aq as Cn,ar as Sn,ab as Xe,as as yt,at as jn,X as Pn,n as ft,e as J,a7 as Bt,a8 as Dn,D as vn,y as An,z as Ln,E as kn,_ as cn,F as On,d as ze,a3 as $n,a4 as Ut,u as Mn,a9 as qt,J as Tn,a1 as xe,a as _e}from"./index-2TEkS4Tk.js";import{l as Nt}from"./lodash-CxsAddGS.js";import{g as En}from"./bankApis-C8Ta4s8G.js";import{D as Rn}from"./DeleteModal-CWdUgVUc.js";import{T as Fn}from"./TablePagination-DstB3iTg.js";import{V as Nn}from"./Visibility-RfWQbd6l.js";import{A as Wn}from"./AddClient-2kBVpEQJ.js";import{T as dn,a as Ot}from"./Tabs-BxNyk1aI.js";import{P as pn}from"./Popper-Djxv1BQt.js";import"./KeyboardArrowRight-D-ZOxJ7W.js";import"./LastPage-TR1pquDU.js";import"./index.esm-Q7QO3LVB.js";const Bn=nn(e.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),_n=nn(e.jsx("path",{d:"M8 5v14l11-7z"}));function zn(t){const o=d.useRef({});return d.useEffect(()=>{o.current=t}),o.current}function Yt({array1:t,array2:o,parser:s=p=>p}){return t&&o&&t.length===o.length&&t.every((p,m)=>s(p)===s(o[m]))}function Qt(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Hn(t={}){const{ignoreAccents:o=!0,ignoreCase:s=!0,limit:p,matchFrom:m="any",stringify:u,trim:f=!1}=t;return(S,{inputValue:j,getOptionLabel:E})=>{let v=f?j.trim():j;s&&(v=v.toLowerCase()),o&&(v=Qt(v));const R=v?S.filter(z=>{let I=(u||E)(z);return s&&(I=I.toLowerCase()),o&&(I=Qt(I)),m==="start"?I.startsWith(v):I.includes(v)}):S;return typeof p=="number"?R.slice(0,p):R}}const Vn=Hn(),Zt=5,Gn=t=>t.current!==null&&t.current.parentElement?.contains(document.activeElement),Kn=[];function Jt(t,o,s,p){if(o||t==null||p)return"";const m=s(t);return typeof m=="string"?m:""}function Un(t){const{unstable_isActiveElementInListbox:o=Gn,unstable_classNamePrefix:s="Mui",autoComplete:p=!1,autoHighlight:m=!1,autoSelect:u=!1,blurOnSelect:f=!1,clearOnBlur:S=!t.freeSolo,clearOnEscape:j=!1,componentName:E="useAutocomplete",defaultValue:v=t.multiple?Kn:null,disableClearable:R=!1,disableCloseOnSelect:z=!1,disabled:I,disabledItemsFocusable:A=!1,disableListWrap:H=!1,filterOptions:P=Vn,filterSelectedOptions:M=!1,freeSolo:U=!1,getOptionDisabled:F,getOptionKey:ie,getOptionLabel:ye=r=>r.label??r,groupBy:V,handleHomeEndKeys:x=!t.freeSolo,id:He,includeInputInList:ne=!1,inputValue:Me,isOptionEqualToValue:ce=(r,n)=>r===n,multiple:l=!1,onChange:w,onClose:Ie,onHighlightChange:$,onInputChange:ae,onOpen:Ve,open:It,openOnFocus:Tt=!1,options:Te,readOnly:de=!1,renderValue:X,selectOnFocus:ht=!t.freeSolo,value:st}=t,oe=un(He);let G=ye;G=r=>{const n=ye(r);return typeof n!="string"?String(n):n};const Ee=d.useRef(!1),et=d.useRef(!0),N=d.useRef(null),re=d.useRef(null),[Ge,wt]=d.useState(null),[Q,Ke]=d.useState(-1),tt=m?0:-1,K=d.useRef(tt),xt=d.useRef(Jt(v??st,l,G)).current,[g,Ue]=Et({controlled:st,default:v,name:E}),[D,ve]=Et({controlled:Me,default:xt,name:E,state:"inputValue"}),[qe,lt]=d.useState(!1),Ye=d.useCallback((r,n,i)=>{if(!(l?g.length<n.length:n!==null)&&!S)return;const b=Jt(n,l,G,X);D!==b&&(ve(b),ae&&ae(r,b,i))},[G,D,l,ae,ve,S,g,X]),[we,Re]=Et({controlled:It,default:!1,name:E,state:"open"}),[Ct,Qe]=d.useState(!0),it=!l&&g!=null&&D===G(g),q=we&&!de,k=q?P(Te.filter(r=>!(M&&(l?g:[g]).some(n=>n!==null&&ce(r,n)))),{inputValue:it&&Ct?"":D,getOptionLabel:G}):[],Z=zn({filteredOptions:k,value:g,inputValue:D});d.useEffect(()=>{const r=g!==Z.value;qe&&!r||U&&!r||Ye(null,g,"reset")},[g,Ye,qe,Z.value,U]);const ct=we&&k.length>0&&!de,pe=Pt(r=>{if(r===-1)N.current.focus();else{const n=X?"data-item-index":"data-tag-index";Ge.querySelector(`[${n}="${r}"]`).focus()}});d.useEffect(()=>{l&&Q>g.length-1&&(Ke(-1),pe(-1))},[g,l,Q,pe]);function dt(r,n){if(!re.current||r<0||r>=k.length)return-1;let i=r;for(;;){const h=re.current.querySelector(`[data-option-index="${i}"]`),b=A?!1:!h||h.disabled||h.getAttribute("aria-disabled")==="true";if(h&&h.hasAttribute("tabindex")&&!b)return i;if(n==="next"?i=(i+1)%k.length:i=(i-1+k.length)%k.length,i===r)return-1}}const Ce=Pt(({event:r,index:n,reason:i})=>{if(K.current=n,n===-1?N.current.removeAttribute("aria-activedescendant"):N.current.setAttribute("aria-activedescendant",`${oe}-option-${n}`),$&&["mouse","keyboard","touch"].includes(i)&&$(r,n===-1?null:k[n],i),!re.current)return;const h=re.current.querySelector(`[role="option"].${s}-focused`);h&&(h.classList.remove(`${s}-focused`),h.classList.remove(`${s}-focusVisible`));let b=re.current;if(re.current.getAttribute("role")!=="listbox"&&(b=re.current.parentElement.querySelector('[role="listbox"]')),!b)return;if(n===-1){b.scrollTop=0;return}const Y=re.current.querySelector(`[data-option-index="${n}"]`);if(Y&&(Y.classList.add(`${s}-focused`),i==="keyboard"&&Y.classList.add(`${s}-focusVisible`),b.scrollHeight>b.clientHeight&&i!=="mouse"&&i!=="touch")){const B=Y,De=b.clientHeight+b.scrollTop,jt=B.offsetTop+B.offsetHeight;jt>De?b.scrollTop=jt-b.clientHeight:B.offsetTop-B.offsetHeight*(V?1.3:0)<b.scrollTop&&(b.scrollTop=B.offsetTop-B.offsetHeight*(V?1.3:0))}}),ue=Pt(({event:r,diff:n,direction:i="next",reason:h})=>{if(!q)return;const Y=dt((()=>{const B=k.length-1;if(n==="reset")return tt;if(n==="start")return 0;if(n==="end")return B;const De=K.current+n;return De<0?De===-1&&ne?-1:H&&K.current!==-1||Math.abs(n)>1?0:B:De>B?De===B+1&&ne?-1:H||Math.abs(n)>1?B:0:De})(),i);if(Ce({index:Y,reason:h,event:r}),p&&n!=="reset")if(Y===-1)N.current.value=D;else{const B=G(k[Y]);N.current.value=B,B.toLowerCase().indexOf(D.toLowerCase())===0&&D.length>0&&N.current.setSelectionRange(D.length,B.length)}}),nt=!Yt({array1:Z.filteredOptions,array2:k,parser:G}),pt=()=>{const r=(n,i)=>{const h=n?G(n):"",b=i?G(i):"";return h===b};if(K.current!==-1&&!Yt({array1:Z.filteredOptions,array2:k,parser:G})&&Z.inputValue===D&&(l?g.length===Z.value.length&&Z.value.every((n,i)=>G(g[i])===G(n)):r(Z.value,g))){const n=Z.filteredOptions[K.current];if(n)return k.findIndex(i=>G(i)===G(n))}return-1},ot=d.useCallback(()=>{if(!q)return;const r=pt();if(r!==-1){K.current=r;return}const n=l?g[0]:g;if(k.length===0||n==null){ue({diff:"reset"});return}if(re.current){if(n!=null){const i=k[K.current];if(l&&i&&g.findIndex(b=>ce(i,b))!==-1)return;const h=k.findIndex(b=>ce(b,n));h===-1?ue({diff:"reset"}):Ce({index:h});return}if(K.current>=k.length-1){Ce({index:k.length-1});return}Ce({index:K.current})}},[k.length,l?!1:g,M,ue,Ce,q,D,l]),Ae=Pt(r=>{fn(re,r),r&&ot()});d.useEffect(()=>{(nt||q)&&ot()},[ot,nt,q]);const Se=r=>{we||(Re(!0),Qe(!0),Ve&&Ve(r))},Fe=(r,n)=>{we&&(Re(!1),Ie&&Ie(r,n))},ee=(r,n,i,h)=>{if(l){if(g.length===n.length&&g.every((b,Y)=>b===n[Y]))return}else if(g===n)return;w&&w(r,n,i,h),Ue(n)},je=d.useRef(!1),fe=(r,n,i="selectOption",h="options")=>{let b=i,Y=n;if(l){Y=Array.isArray(g)?g.slice():[];const B=Y.findIndex(De=>ce(n,De));B===-1?Y.push(n):h!=="freeSolo"&&(Y.splice(B,1),b="removeOption")}Ye(r,Y,b),ee(r,Y,b,{option:n}),!z&&(!r||!r.ctrlKey&&!r.metaKey)&&Fe(r,b),(f===!0||f==="touch"&&je.current||f==="mouse"&&!je.current)&&N.current.blur()};function mt(r,n){if(r===-1)return-1;let i=r;for(;;){if(n==="next"&&i===g.length||n==="previous"&&i===-1)return-1;const h=X?"data-item-index":"data-tag-index",b=Ge.querySelector(`[${h}="${i}"]`);if(!b||!b.hasAttribute("tabindex")||b.disabled||b.getAttribute("aria-disabled")==="true")i+=n==="next"?1:-1;else return i}}const Ne=(r,n)=>{if(!l)return;D===""&&Fe(r,"toggleInput");let i=Q;Q===-1?D===""&&n==="previous"&&(i=g.length-1):(i+=n==="next"?1:-1,i<0&&(i=0),i===g.length&&(i=-1)),i=mt(i,n),Ke(i),pe(i)},ge=r=>{Ee.current=!0,ve(""),ae&&ae(r,"","clear"),ee(r,l?[]:null,"clear")},a=r=>n=>{if(r.onKeyDown&&r.onKeyDown(n),!n.defaultMuiPrevented&&(Q!==-1&&!["ArrowLeft","ArrowRight"].includes(n.key)&&(Ke(-1),pe(-1)),n.which!==229))switch(n.key){case"Home":q&&x&&(n.preventDefault(),ue({diff:"start",direction:"next",reason:"keyboard",event:n}));break;case"End":q&&x&&(n.preventDefault(),ue({diff:"end",direction:"previous",reason:"keyboard",event:n}));break;case"PageUp":n.preventDefault(),ue({diff:-Zt,direction:"previous",reason:"keyboard",event:n}),Se(n);break;case"PageDown":n.preventDefault(),ue({diff:Zt,direction:"next",reason:"keyboard",event:n}),Se(n);break;case"ArrowDown":n.preventDefault(),ue({diff:1,direction:"next",reason:"keyboard",event:n}),Se(n);break;case"ArrowUp":n.preventDefault(),ue({diff:-1,direction:"previous",reason:"keyboard",event:n}),Se(n);break;case"ArrowLeft":!l&&X?pe(0):Ne(n,"previous");break;case"ArrowRight":!l&&X?pe(-1):Ne(n,"next");break;case"Enter":if(K.current!==-1&&q){const i=k[K.current],h=F?F(i):!1;if(n.preventDefault(),h)return;fe(n,i,"selectOption"),p&&N.current.setSelectionRange(N.current.value.length,N.current.value.length)}else U&&D!==""&&it===!1&&(l&&n.preventDefault(),fe(n,D,"createOption","freeSolo"));break;case"Escape":q?(n.preventDefault(),n.stopPropagation(),Fe(n,"escape")):j&&(D!==""||l&&g.length>0||X)&&(n.preventDefault(),n.stopPropagation(),ge(n));break;case"Backspace":if(l&&!de&&D===""&&g.length>0){const i=Q===-1?g.length-1:Q,h=g.slice();h.splice(i,1),ee(n,h,"removeOption",{option:g[i]})}!l&&X&&!de&&(Ue(null),pe(-1));break;case"Delete":if(l&&!de&&D===""&&g.length>0&&Q!==-1){const i=Q,h=g.slice();h.splice(i,1),ee(n,h,"removeOption",{option:g[i]})}!l&&X&&!de&&(Ue(null),pe(-1));break}},c=r=>{lt(!0),Tt&&!Ee.current&&Se(r)},L=r=>{if(o(re)){N.current.focus();return}lt(!1),et.current=!0,Ee.current=!1,u&&K.current!==-1&&q?fe(r,k[K.current],"blur"):u&&U&&D!==""?fe(r,D,"blur","freeSolo"):S&&Ye(r,g,"blur"),Fe(r,"blur")},se=r=>{const n=r.target.value;D!==n&&(ve(n),Qe(!1),ae&&ae(r,n,"input")),n===""?!R&&!l&&ee(r,null,"clear"):Se(r)},Le=r=>{const n=Number(r.currentTarget.getAttribute("data-option-index"));K.current!==n&&Ce({event:r,index:n,reason:"mouse"})},We=r=>{Ce({event:r,index:Number(r.currentTarget.getAttribute("data-option-index")),reason:"touch"}),je.current=!0},ke=r=>{const n=Number(r.currentTarget.getAttribute("data-option-index"));fe(r,k[n],"selectOption"),je.current=!1},he=r=>n=>{const i=g.slice();i.splice(r,1),ee(n,i,"removeOption",{option:g[r]})},Be=r=>{ee(r,null,"removeOption",{option:g})},T=r=>{we?Fe(r,"toggleInput"):Se(r)},W=r=>{r.currentTarget.contains(r.target)&&r.target.getAttribute("id")!==oe&&r.preventDefault()},Pe=r=>{r.currentTarget.contains(r.target)&&(N.current.focus(),ht&&et.current&&N.current.selectionEnd-N.current.selectionStart===0&&N.current.select(),et.current=!1)},Oe=r=>{!I&&(D===""||!we)&&T(r)};let le=U&&D.length>0;le=le||(l?g.length>0:g!==null);let St=k;return V&&(St=k.reduce((r,n,i)=>{const h=V(n);return r.length>0&&r[r.length-1].group===h?r[r.length-1].options.push(n):r.push({key:i,index:i,group:h,options:[n]}),r},[])),I&&qe&&L(),{getRootProps:(r={})=>({...r,onKeyDown:a(r),onMouseDown:W,onClick:Pe}),getInputLabelProps:()=>({id:`${oe}-label`,htmlFor:oe}),getInputProps:()=>({id:oe,value:D,onBlur:L,onFocus:c,onChange:se,onMouseDown:Oe,"aria-activedescendant":q?"":null,"aria-autocomplete":p?"both":"list","aria-controls":ct?`${oe}-listbox`:void 0,"aria-expanded":ct,autoComplete:"off",ref:N,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:I}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:ge}),getItemProps:({index:r=0}={})=>({...l&&{key:r},...X?{"data-item-index":r}:{"data-tag-index":r},tabIndex:-1,...!de&&{onDelete:l?he(r):Be}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:T}),getTagProps:({index:r})=>({key:r,"data-tag-index":r,tabIndex:-1,...!de&&{onDelete:he(r)}}),getListboxProps:()=>({role:"listbox",id:`${oe}-listbox`,"aria-labelledby":`${oe}-label`,ref:Ae,onMouseDown:r=>{r.preventDefault()}}),getOptionProps:({index:r,option:n})=>{const i=(l?g:[g]).some(b=>b!=null&&ce(n,b)),h=F?F(n):!1;return{key:ie?.(n)??G(n),tabIndex:-1,role:"option",id:`${oe}-option-${r}`,onMouseMove:Le,onClick:ke,onTouchStart:We,"data-option-index":r,"aria-disabled":h,"aria-selected":i}},id:oe,inputValue:D,value:g,dirty:le,expanded:q&&Ge,popupOpen:q,focused:qe||Q!==-1,anchorEl:Ge,setAnchorEl:wt,focusedItem:Q,focusedTag:Q,groupedOptions:St}}function qn(t){return on("MuiListSubheader",t)}rn("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const Yn=t=>{const{classes:o,color:s,disableGutters:p,inset:m,disableSticky:u}=t,f={root:["root",s!=="default"&&`color${$t(s)}`,!p&&"gutters",m&&"inset",!u&&"sticky"]};return sn(f,qn,o)},Qn=be("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,s.color!=="default"&&o[`color${$t(s.color)}`],!s.disableGutters&&o.gutters,s.inset&&o.inset,!s.disableSticky&&o.sticky]}})(at(({theme:t})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(t.vars||t).palette.text.secondary,fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(t.vars||t).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:o})=>!o.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:o})=>o.inset,style:{paddingLeft:72}},{props:({ownerState:o})=>!o.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(t.vars||t).palette.background.paper}}]}))),_t=d.forwardRef(function(o,s){const p=an({props:o,name:"MuiListSubheader"}),{className:m,color:u="default",component:f="li",disableGutters:S=!1,disableSticky:j=!1,inset:E=!1,...v}=p,R={...p,color:u,component:f,disableGutters:S,disableSticky:j,inset:E},z=Yn(R);return e.jsx(Qn,{as:f,className:vt(z.root,m),ref:s,ownerState:R,...v})});_t&&(_t.muiSkipListHighlight=!0);function Zn(t){return on("MuiAutocomplete",t)}const y=rn("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var Xt,en;const Jn=t=>{const{classes:o,disablePortal:s,expanded:p,focused:m,fullWidth:u,hasClearIcon:f,hasPopupIcon:S,inputFocused:j,popupOpen:E,size:v}=t,R={root:["root",p&&"expanded",m&&"focused",u&&"fullWidth",f&&"hasClearIcon",S&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",j&&"inputFocused"],tag:["tag",`tagSize${$t(v)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",E&&"popupIndicatorOpen"],popper:["popper",s&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return sn(R,Zn,o)},Xn=be("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t,{fullWidth:p,hasClearIcon:m,hasPopupIcon:u,inputFocused:f,size:S}=s;return[{[`& .${y.tag}`]:o.tag},{[`& .${y.tag}`]:o[`tagSize${$t(S)}`]},{[`& .${y.inputRoot}`]:o.inputRoot},{[`& .${y.input}`]:o.input},{[`& .${y.input}`]:f&&o.inputFocused},o.root,p&&o.fullWidth,u&&o.hasPopupIcon,m&&o.hasClearIcon]}})({[`&.${y.focused} .${y.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${y.clearIndicator}`]:{visibility:"visible"}},[`& .${y.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${y.inputRoot}`]:{[`.${y.hasPopupIcon}&, .${y.hasClearIcon}&`]:{paddingRight:30},[`.${y.hasPopupIcon}.${y.hasClearIcon}&`]:{paddingRight:56},[`& .${y.input}`]:{width:0,minWidth:30}},[`& .${Ft.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Ft.root}.${rt.sizeSmall}`]:{[`& .${Ft.input}`]:{padding:"2px 4px 3px 0"}},[`& .${Kt.root}`]:{padding:9,[`.${y.hasPopupIcon}&, .${y.hasClearIcon}&`]:{paddingRight:39},[`.${y.hasPopupIcon}.${y.hasClearIcon}&`]:{paddingRight:65},[`& .${y.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${y.endAdornment}`]:{right:9}},[`& .${Kt.root}.${rt.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${y.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${ut.root}`]:{paddingTop:19,paddingLeft:8,[`.${y.hasPopupIcon}&, .${y.hasClearIcon}&`]:{paddingRight:39},[`.${y.hasPopupIcon}.${y.hasClearIcon}&`]:{paddingRight:65},[`& .${ut.input}`]:{padding:"7px 4px"},[`& .${y.endAdornment}`]:{right:9}},[`& .${ut.root}.${rt.sizeSmall}`]:{paddingBottom:1,[`& .${ut.input}`]:{padding:"2.5px 4px"}},[`& .${rt.hiddenLabel}`]:{paddingTop:8},[`& .${ut.root}.${rt.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${y.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${ut.root}.${rt.hiddenLabel}.${rt.sizeSmall}`]:{[`& .${y.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${y.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${y.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${y.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${y.inputRoot}`]:{flexWrap:"wrap"}}}]}),eo=be("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),to=be(Mt,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),no=be(Mt,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.popupIndicator,s.popupOpen&&o.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),oo=be(pn,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[{[`& .${y.option}`]:o.option},o.popper,s.disablePortal&&o.popperDisablePortal]}})(at(({theme:t})=>({zIndex:(t.vars||t).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),ro=be(gt,{name:"MuiAutocomplete",slot:"Paper"})(at(({theme:t})=>({...t.typography.body1,overflow:"auto"}))),ao=be("div",{name:"MuiAutocomplete",slot:"Loading"})(at(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),so=be("div",{name:"MuiAutocomplete",slot:"NoOptions"})(at(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),lo=be("ul",{name:"MuiAutocomplete",slot:"Listbox"})(at(({theme:t})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${y.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[t.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${y.focused}`]:{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${y.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${y.focused}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${y.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}}}}))),io=be(_t,{name:"MuiAutocomplete",slot:"GroupLabel"})(at(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,top:-8}))),co=be("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${y.option}`]:{paddingLeft:24}}),Wt=d.forwardRef(function(o,s){const p=an({props:o,name:"MuiAutocomplete"}),{autoComplete:m=!1,autoHighlight:u=!1,autoSelect:f=!1,blurOnSelect:S=!1,ChipProps:j,className:E,clearIcon:v=Xt||(Xt=e.jsx(gn,{fontSize:"small"})),clearOnBlur:R=!p.freeSolo,clearOnEscape:z=!1,clearText:I="Clear",closeText:A="Close",componentsProps:H,defaultValue:P=p.multiple?[]:null,disableClearable:M=!1,disableCloseOnSelect:U=!1,disabled:F=!1,disabledItemsFocusable:ie=!1,disableListWrap:ye=!1,disablePortal:V=!1,filterOptions:x,filterSelectedOptions:He=!1,forcePopupIcon:ne="auto",freeSolo:Me=!1,fullWidth:ce=!1,getLimitTagsText:l=C=>`+${C}`,getOptionDisabled:w,getOptionKey:Ie,getOptionLabel:$,isOptionEqualToValue:ae,groupBy:Ve,handleHomeEndKeys:It=!p.freeSolo,id:Tt,includeInputInList:Te=!1,inputValue:de,limitTags:X=-1,ListboxComponent:ht,ListboxProps:st,loading:oe=!1,loadingText:G="Loading…",multiple:Ee=!1,noOptionsText:et="No options",onChange:N,onClose:re,onHighlightChange:Ge,onInputChange:wt,onOpen:Q,open:Ke,openOnFocus:tt=!1,openText:K="Open",options:xt,PaperComponent:g,PopperComponent:Ue,popupIcon:D=en||(en=e.jsx(hn,{})),readOnly:ve=!1,renderGroup:qe,renderInput:lt,renderOption:Ye,renderTags:we,renderValue:Re,selectOnFocus:Ct=!p.freeSolo,size:Qe="medium",slots:it={},slotProps:q={},value:k,...Z}=p,{getRootProps:ct,getInputProps:pe,getInputLabelProps:dt,getPopupIndicatorProps:Ce,getClearProps:ue,getItemProps:nt,getListboxProps:pt,getOptionProps:ot,value:Ae,dirty:Se,expanded:Fe,id:ee,popupOpen:je,focused:fe,focusedItem:mt,anchorEl:Ne,setAnchorEl:ge,inputValue:a,groupedOptions:c}=Un({...p,componentName:"Autocomplete"}),L=!M&&!F&&Se&&!ve,se=(!Me||ne===!0)&&ne!==!1,{onMouseDown:Le}=pe(),{ref:We,...ke}=pt(),Be=$||(C=>C.label??C),T={...p,disablePortal:V,expanded:Fe,focused:fe,fullWidth:ce,getOptionLabel:Be,hasClearIcon:L,hasPopupIcon:se,inputFocused:mt===-1,popupOpen:je,size:Qe},W=Jn(T),Pe={slots:{paper:g,popper:Ue,...it},slotProps:{chip:j,listbox:st,...H,...q}},[Oe,le]=Rt("listbox",{elementType:lo,externalForwardedProps:Pe,ownerState:T,className:W.listbox,additionalProps:ke,ref:We}),[St,r]=Rt("paper",{elementType:gt,externalForwardedProps:Pe,ownerState:T,className:W.paper}),[n,i]=Rt("popper",{elementType:pn,externalForwardedProps:Pe,ownerState:T,className:W.popper,additionalProps:{disablePortal:V,style:{width:Ne?Ne.clientWidth:null},role:"presentation",anchorEl:Ne,open:je}});let h;const b=C=>({className:W.tag,disabled:F,...nt(C)});if(Ee?Ae.length>0&&(we?h=we(Ae,b,T):Re?h=Re(Ae,b,T):h=Ae.map((C,Ze)=>{const{key:Je,...bt}=b({index:Ze});return e.jsx(zt,{label:Be(C),size:Qe,...bt,...Pe.slotProps.chip},Je)})):Re&&Ae!=null&&(h=Re(Ae,b,T)),X>-1&&Array.isArray(h)){const C=h.length-X;!fe&&C>0&&(h=h.splice(0,X),h.push(e.jsx("span",{className:W.tag,children:l(C)},h.length)))}const B=qe||(C=>e.jsxs("li",{children:[e.jsx(io,{className:W.groupLabel,ownerState:T,component:"div",children:C.group}),e.jsx(co,{className:W.groupUl,ownerState:T,children:C.children})]},C.key)),jt=Ye||((C,Ze)=>{const{key:Je,...bt}=C;return e.jsx("li",{...bt,children:Be(Ze)},Je)}),Ht=(C,Ze)=>{const Je=ot({option:C,index:Ze});return jt({...Je,className:W.option},C,{selected:Je["aria-selected"],index:Ze,inputValue:a},T)},Vt=Pe.slotProps.clearIndicator,Gt=Pe.slotProps.popupIndicator;return e.jsxs(d.Fragment,{children:[e.jsx(Xn,{ref:s,className:vt(W.root,E),ownerState:T,...ct(Z),children:lt({id:ee,disabled:F,fullWidth:!0,size:Qe==="small"?"small":void 0,InputLabelProps:dt(),InputProps:{ref:ge,className:W.inputRoot,startAdornment:h,onMouseDown:C=>{C.target===C.currentTarget&&Le(C)},...(L||se)&&{endAdornment:e.jsxs(eo,{className:W.endAdornment,ownerState:T,children:[L?e.jsx(to,{...ue(),"aria-label":I,title:I,ownerState:T,...Vt,className:vt(W.clearIndicator,Vt?.className),children:v}):null,se?e.jsx(no,{...Ce(),disabled:F,"aria-label":je?A:K,title:je?A:K,ownerState:T,...Gt,className:vt(W.popupIndicator,Gt?.className),children:D}):null]})}},inputProps:{className:W.input,disabled:F,readOnly:ve,...pe()}})}),Ne?e.jsx(oo,{as:n,...i,children:e.jsxs(ro,{as:St,...r,children:[oe&&c.length===0?e.jsx(ao,{className:W.loading,ownerState:T,children:G}):null,c.length===0&&!Me&&!oe?e.jsx(so,{className:W.noOptions,ownerState:T,role:"presentation",onMouseDown:C=>{C.preventDefault()},children:et}):null,c.length>0?e.jsx(Oe,{as:ht,...le,children:c.map((C,Ze)=>Ve?B({key:C.key,group:C.group,children:C.options.map((Je,bt)=>Ht(Je,C.index+bt))}):Ht(C,Ze))}):null]})}):null]})}),po=async(t=1,o="")=>{try{const s=o?`/api/clients/all/${t}?search=${encodeURIComponent(o)}`:`/api/clients/all/${t}`;return(await me.get(s)).data}catch(s){throw $e(s),s}},uo=async(t=1,o="")=>{try{const s=o?`/api/partners/all/${t}?search=${encodeURIComponent(o)}`:`/api/partners/all/${t}`;return(await me.get(s)).data}catch(s){throw $e(s),s}},fo=async t=>{try{return(await me.post("/api/loans",t)).data}catch(o){throw $e(o),o}},go=async(t,o)=>{try{return(await me.patch(`/api/loans/${t}`,o)).data}catch(s){throw $e(s),s}},ho=async t=>{try{return(await me.patch(`/api/loans/${t}/activate`)).data}catch(o){throw $e(o),o}},xo=async t=>{try{return(await me.patch(`/api/loans/${t}/deactivate`)).data}catch(o){throw $e(o),o}},mo=async(t=1,o="")=>{try{const s=o?`/api/loans/all/${t}?search=${encodeURIComponent(o)}`:`/api/loans/all/${t}`;return(await me.get(s)).data}catch(s){throw $e(s),s}},bo=async t=>{try{return(await me.get(`/api/loans/${t}`)).data}catch(o){throw $e(o),o}},yo=async t=>{try{return(await me.delete(`/api/loans/${t}`)).data}catch(o){throw $e(o),o}},Io=({onViewDetails:t,onViewInstallments:o})=>{const[s,p]=d.useState(1),[m,u]=d.useState(""),[f,S]=d.useState(null),[j,E]=d.useState(!1),v=ln(),[R,z]=d.useState(null),[I,A]=d.useState(null),H=(l,w)=>{z(l.currentTarget),A(w)},P=()=>{z(null),A(null)},{data:M,isLoading:U}=At({queryKey:["loans",s,m],queryFn:()=>mo(s,m),retry:1}),F=l=>{u(l.target.value),p(1)},ie=(l,w)=>{p(w+1)},ye=async l=>{try{await yo(l),ft("تم حذف السلفة بنجاح"),v.invalidateQueries(["loans"]),E(!1),S(null)}catch(w){J(w.response?.data?.message||"حدث خطأ أثناء حذف السلفة")}},V=async l=>{try{await ho(l),ft("تم تفعيل السلفة بنجاح"),v.invalidateQueries(["loans"])}catch(w){J(w.response?.data?.message||"حدث خطأ أثناء تفعيل السلفة")}},x=async l=>{try{await xo(l),ft("تم إلغاء تفعيل السلفة بنجاح"),v.invalidateQueries(["loans"])}catch(w){J(w.response?.data?.message||"حدث خطأ أثناء إلغاء تفعيل السلفة")}},He=l=>{if(l.status==="PENDING"){J("يجب تفعيل السلفة أولاً لعرض الأقساط");return}o(l)},ne=l=>{switch(l){case"PENDING":return"warning";case"ACTIVE":return"success";case"COMPLETED":return"info";case"DEFAULTED":return"error";default:return"default"}},Me=l=>{switch(l){case"PENDING":return"قيد المراجعة";case"ACTIVE":return"نشط";case"COMPLETED":return"مكتمل";case"DEFAULTED":return"متأخر";default:return l}},ce=l=>{switch(l){case"DAILY":return"يومي";case"WEEKLY":return"أسبوعي";case"MONTHLY":return"شهري";default:return l}};return e.jsxs(_,{sx:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[e.jsx(_,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(xn,{placeholder:"ابحث باسم العميل أو رقم السلفة...",value:m,onChange:F,sx:{width:"280px",borderRadius:"6px"}})}),e.jsx(gt,{sx:{flex:1,width:"100%",overflow:"hidden"},children:e.jsx(mn,{sx:{height:"100%",width:"100%"},children:e.jsxs(bn,{stickyHeader:!0,sx:{width:"100%"},children:[e.jsx(yn,{children:e.jsxs(Dt,{children:[e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"رقم السلفة"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"العميل"}),e.jsxs(O,{align:"center",sx:{whiteSpace:"nowrap"},children:[" ","المستثمر"]}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"الحساب البنكي"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"مبلغ السلفة"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"معدل الفائدة"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"المدة"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"النوع"}),e.jsxs(O,{align:"center",sx:{whiteSpace:"nowrap"},children:[" ","يوم الاستحقاق"]}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"الحالة"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"تاريخ البدء"}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:"الإجراءات"})]})}),e.jsx(In,{children:U?e.jsx(Dt,{children:e.jsx(O,{colSpan:12,align:"center",children:e.jsx(Lt,{size:20})})}):M?.data?.length===0?e.jsx(Dt,{children:e.jsx(O,{colSpan:12,align:"center",children:e.jsx(te,{children:"لا توجد سلف"})})}):M?.data?.map(l=>e.jsxs(Dt,{hover:!0,children:[e.jsx(O,{children:l.code}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:l.client?.name}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:l.partner?.name}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:l.bankAccount?.name}),e.jsxs(O,{align:"center",sx:{whiteSpace:"nowrap",fontWeight:"bold"},children:[l.amount?.toLocaleString()," ر.س"]}),e.jsxs(O,{align:"center",sx:{whiteSpace:"nowrap"},children:[l.interestRate,"%"]}),e.jsxs(O,{align:"center",sx:{whiteSpace:"nowrap"},children:[l.durationMonths," شهر"]}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:ce(l.type)}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:l.repaymentDay}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:e.jsx(zt,{label:Me(l.status),color:ne(l.status),size:"small"})}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:wn(l.startDate).format("DD/MM/YYYY")}),e.jsx(O,{align:"center",sx:{whiteSpace:"nowrap"},children:e.jsx(Mt,{size:"small",onClick:w=>H(w,l),children:e.jsx(Cn,{fontSize:"small"})})})]},l.id))})]})})}),M&&e.jsx(Fn,{component:"div",count:M.total||0,page:s-1,onPageChange:ie,rowsPerPage:10,rowsPerPageOptions:[10],labelDisplayedRows:({from:l,to:w,count:Ie})=>`عرض ${l}-${w} من ${Ie}`,labelRowsPerPage:"صفوف لكل صفحة:"}),e.jsx(Rn,{open:j,onClose:()=>{E(!1),S(null)},onConfirm:()=>ye(f?.id),title:"حذف السلفة",message:`هل أنت متأكد من حذف سلفة العميل ${f?.client?.name}؟`,ButtonText:"حذف"}),e.jsxs(Sn,{anchorEl:R,open:!!R,onClose:P,children:[e.jsxs(Xe,{onClick:()=>{t(I?.id),P()},sx:{color:"#1976D2"},children:[e.jsx(yt,{children:e.jsx(Nn,{fontSize:"small",sx:{color:"#1976D2"}})}),"عرض السلفة"]}),e.jsxs(Xe,{onClick:()=>{He(I),P()},sx:{color:"#2E7D32"},children:[e.jsx(yt,{children:e.jsx(jn,{fontSize:"small",sx:{color:"#2E7D32"}})}),"عرض الأقساط"]}),I?.status==="PENDING"&&e.jsxs(Xe,{onClick:()=>{V(I?.id),P()},sx:{color:"#FB8C00"},children:[e.jsx(yt,{children:e.jsx(_n,{fontSize:"small",sx:{color:"#FB8C00"}})}),"تفعيل السلفة"]}),I?.status==="ACTIVE"&&e.jsxs(Xe,{onClick:()=>{x(I?.id),P()},sx:{color:"#8E24AA"},children:[e.jsx(yt,{children:e.jsx(Bn,{fontSize:"small",sx:{color:"#8E24AA"}})}),"إلغاء تفعيل السلفة"]}),I?.status!=="ACTIVE"&&e.jsxs(Xe,{onClick:()=>{S(I),E(!0),P()},sx:{color:"#D32F2F"},children:[e.jsx(yt,{children:e.jsx(Pn,{fontSize:"small",sx:{color:"#D32F2F"}})}),"حذف السلفة"]})]})]})},kt=t=>{const o=["","واحد","اثنان","ثلاثة","أربعة","خمسة","ستة","سبعة","ثمانية","تسعة"],s=["","","عشرون","ثلاثون","أربعون","خمسون","ستون","سبعون","ثمانون","تسعون"],p=["عشرة","أحد عشر","اثنا عشر","ثلاثة عشر","أربعة عشر","خمسة عشر","ستة عشر","سبعة عشر","ثمانية عشر","تسعة عشر"],m=["","مائة","مائتان","ثلاثمائة","أربعمائة","خمسمائة","ستمائة","سبعمائة","ثمانمائة","تسعمائة"];if(t===0)return"صفر";if(t<0)return"سالب "+kt(-t);let u="";if(t>=1e6){const f=Math.floor(t/1e6);f===1?u+="مليون ":f===2?u+="مليونان ":f<11?u+=o[f]+" ملايين ":u+=kt(f)+" مليون ",t%=1e6}if(t>=1e3){const f=Math.floor(t/1e3);f===1?u+="ألف ":f===2?u+="ألفان ":f>=10&&f<=19?f===10?u+="عشرة آلاف ":u+=p[f-10]+" ألف ":f<11?u+=o[f]+" آلاف ":u+=kt(f)+" ألف ",t%=1e3}if(t>=100){const f=Math.floor(t/100);u+=m[f]+" ",t%=100}if(t>=20){const f=Math.floor(t/10),S=t%10;S>0?u+=o[S]+" و"+s[f]:u+=s[f]}else t>=10?u+=p[t-10]:t>0&&(u+=o[t]);return u.trim()},wo=()=>{const t=new Date;let s=new Intl.DateTimeFormat("ar-SA-u-ca-islamic-umalqura",{day:"numeric",month:"long",year:"numeric",timeZone:"Asia/Riyadh"}).format(t);return s=s.replace(/\s+/g," ").trim(),s=s.replace(" "," من "),s.includes("هـ")||(s=`${s} هـ`),{gregorianDate:`الموافق ${new Intl.DateTimeFormat("ar-SA-u-ca-gregory",{day:"numeric",month:"long",year:"numeric",timeZone:"Asia/Riyadh"}).format(t)}`,hijriDate:s}},tn=Bt.forwardRef(({loanData:t,clientData:o,templateContent:s,onContractGenerated:p,contractType:m="DEBT_ACKNOWLEDGMENT",autoGenerate:u=!1},f)=>{const[S,j]=d.useState(""),[E,v]=d.useState(!1),R=d.useCallback(async A=>{try{const H=new FormData,P=m==="DEBT_ACKNOWLEDGMENT"?`إقرار الدين_${t.id}_${Date.now()}.pdf`:`سند الأمر_${t.id}_${Date.now()}.pdf`;H.append("file",A,P);const M=m==="DEBT_ACKNOWLEDGMENT"?`/api/loans/${t.id}/upload-debt-acknowledgment`:`/api/loans/${t.id}/upload-promissory-note`;console.log("Uploading to endpoint:",M);const U=await me.post(M,H,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Upload response:",U.data),U.data}catch(H){throw console.error("Error uploading PDF:",H),H}},[m,t?.id]),z=d.useCallback(async(A=S)=>{const H=A||S;if(!H){console.error("No contract HTML to generate PDF"),J("لا يوجد محتوى عقد لتحويله إلى PDF");return}try{v(!0);const P=document.createElement("div");P.id=`contract-preview-${Date.now()}`,P.style.width="210mm",P.style.minHeight="297mm",P.innerHTML=`
        <div style="
          font-family: 'Cairo', 'Noto Sans Arabic', sans-serif;
          padding: 20mm;
          background: white;
          direction: rtl;
        ">
          ${H}
        </div>
      `,document.body.appendChild(P);const M={margin:0,filename:`${m.toLowerCase()}_${o.id}_${Date.now()}.pdf`,image:{type:"jpeg",quality:1},html2canvas:{scale:3,useCORS:!0,letterRendering:!0,allowTaint:!0,logging:!0,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"a4",orientation:"portrait",compress:!1,hotfixes:["px_scaling"]}};console.log("Generating PDF for:",m),await new Promise(ie=>setTimeout(ie,1e3));const U=document.getElementById(P.id),F=await Dn().from(U).set(M).outputPdf("blob");return document.body.removeChild(P),await R(F),console.log("PDF generated and uploaded successfully for:",m),p&&p(F,m),F}catch(P){throw console.error("Error generating PDF:",P),J("حدث خطأ أثناء إنشاء ملف PDF"),$e(P),P}finally{v(!1)}},[m,t?.id,R,p]),I=d.useCallback(async(A=u,H=null)=>{const P=H||t;if(!P||!s){console.error("Missing data:",{loanDataToUse:P,templateContent:s}),J("بيانات السلفة أو العميل أو قالب العقد غير متوفر");return}try{console.log("Generating contract:",m),console.log("Loan Data to use:",P);const{gregorianDate:M,hijriDate:U}=wo(),F=`${U}
${M}`,ie=P.amount||0,ye=kt(ie);console.log("Amount:",ie,"Amount in words:",ye);let V=s.replace(/{{اسم_العميل}}/g,o.name||"").replace(/{{رقم_هوية_العميل}}/g,o.nationalId||"").replace(/{{عنوان_العميل}}/g,o.city+" - "+o.district||"").replace(/{{المبلغ_رقما}}/g,`${ie?.toLocaleString("en-US")||"0"} ريال سعودي`).replace(/{{المبلغ_كتابة}}/g,`${ye} ريال سعودي`).replace(/{{قيمة_السند_رقما}}/g,`${ie?.toLocaleString("ar-SA")||"0"} ريال سعودي`).replace(/{{قيمة_السند_كتابة}}/g,`${ye} ريال سعودي`).replace(/{{التاريخ_الهجري}}/g,U).replace(/{{التاريخ_الميلادي}}/g,M).replace(/{{تاريخ_الانشاء}}/g,F).replace(/{{تاريخ_الاستحقاق}}/g,"لدي الاطلاع").replace(/{{اسم_الدائن}}/g,"أحمد لحول").replace(/{{اسم_المدين}}/g,o.name||"").replace(/{{رقم_السند}}/g,`LOAN-${Date.now()}`).replace(/{{رقم_الإقرار}}/g,`ACK-${Date.now()}`).replace(/{{مدينة_الاصدار}}/g,"شروة - المملكة العربية السعودية").replace(/{{مدينة_الوفاء}}/g,"الرياض - المملكة العربية السعودية").replace(/{{سبب_انشاء_السند}}/g,"سلفة مالية").replace(/{{رقم_هوية_الدائن}}/g,"1234567890").replace(/{{رقم_هوية_المدين}}/g,o.nationalId||"").replace(/{{رقم_هوية_الكفيل}}/g,o.nationalId||"").replace(/{{هوية_الدائن}}/g,"1234567890").replace(/{{هوية_المدين}}/g,o.nationalId||"").replace(/{{اسم_الكفيل}}/g,o.name||"").replace(/{{هوية_الكفيل}}/g,o.nationalId||"");return console.log("Filled Template generated successfully"),console.log("Filled Template Content:",V),console.log("Contract HTML length:",V.length),j(V),A&&(console.log("Auto-generating PDF for:",m),setTimeout(async()=>{try{await z(V)}catch(x){console.error("Error in auto-generating PDF:",x)}},500)),V}catch(M){throw console.error("Error generating contract:",M),M}},[t,o,s,m,u,z]);return d.useEffect(()=>{u&&t&&o&&s&&(console.log("Auto-generating contract:",m),I(!0))},[u,t,o,s,m,I]),Bt.useImperativeHandle(f,()=>({generateContract:I,generatePDF:()=>z(S)})),u?null:e.jsx("div",{style:{width:"100%",border:"1px solid #ddd",marginBottom:"20px",padding:"10px"},children:E&&e.jsx("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#f5f5f5"},children:"جاري إنشاء PDF..."})})}),Co=({open:t,onClose:o,debtAckHtml:s,promissoryNoteHtml:p,onSaveContracts:m,loading:u=!1,clientName:f="",loanAmount:S=0})=>{const[j,E]=Bt.useState(0),v=(I,A)=>{E(A)},R=()=>{const I=document.getElementById(`contract-tab-${j}`);if(I){const A=window.open("","_blank");A.document.write(`
        <html>
          <head>
            <title>${j===0?" إقرار الدين":"سند الأمر"}</title>
            <style>
              body { 
                font-family: "Noto Sans Arabic", "Cairo", sans-serif;
                margin: 0;
                padding: 20px;
                direction: rtl;
              }
              .contract-content { 
                max-width: 900px; 
                margin: 0 auto; 
                border: 1px solid #ddd;
                padding: 30px;
                border-radius: 12px;
                background: #fff;
              }
              @media print {
                body { padding: 0; }
                .contract-content { 
                  border: none; 
                  box-shadow: none;
                  padding: 15px;
                }
              }
            </style>
          </head>
          <body>
            <div class="contract-content">
              ${I.innerHTML}
            </div>
          </body>
        </html>
      `),A.document.close(),A.focus(),setTimeout(()=>{A.print(),A.close()},500)}},z=[{name:"إقرار الدين",html:s,id:"debt-acknowledgment"},{name:"سند الأمر",html:p,id:"promissory-note"}];return e.jsxs(vn,{open:t,onClose:o,maxWidth:"lg",fullWidth:!0,fullScreen:!0,dir:"rtl",PaperProps:{sx:{borderRadius:2,maxHeight:"100vh"}},children:[e.jsxs(An,{className:"no-print",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1,borderBottom:"1px solid #e0e0e0","@media print":{display:"none !important"}},children:[e.jsxs(_,{children:[e.jsx(te,{variant:"h6",fontWeight:"bold",children:"معاينة عقود السلفة"}),f&&e.jsxs(te,{variant:"body2",color:"text.secondary",children:["العميل: ",f," - المبلغ: ",S.toLocaleString()," ر.س"]})]}),e.jsx(Mt,{onClick:o,size:"small",children:e.jsx(Ln,{})})]}),e.jsx(_,{className:"no-print",sx:{borderBottom:1,borderColor:"divider","@media print":{display:"none !important"}},children:e.jsxs(dn,{value:j,onChange:v,centered:!0,children:[e.jsx(Ot,{label:"إقرار الدين",sx:{fontWeight:j===0?"bold":"normal",color:j===0?"#0d40a5":"text.secondary"}}),e.jsx(Ot,{label:"سند الأمر",sx:{fontWeight:j===1?"bold":"normal",color:j===1?"#0d40a5":"text.secondary"}})]})}),e.jsx(kn,{sx:{p:0,display:"flex",flexDirection:"column","@media print":{p:0,m:0}},children:z.map((I,A)=>e.jsx(_,{id:`contract-tab-${A}`,sx:{display:j===A?"block":"none","@media print":{display:"block !important",pageBreakAfter:A===0?"always":"auto"}},children:e.jsx(gt,{sx:{m:3,p:4,minHeight:"500px",bgcolor:"white",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",border:"1px solid #e0e0e0","@media print":{m:0,p:2,boxShadow:"none",border:"none",minHeight:"auto",pageBreakInside:"avoid"}},children:I.html?e.jsx(_,{dangerouslySetInnerHTML:{__html:I.html},sx:{"& *":{fontFamily:'"Noto Sans Arabic", "Cairo", "Segoe UI", sans-serif !important',lineHeight:1.8},"& h1, & h2, & h3":{textAlign:"center",color:"#1976d2",marginBottom:"20px"},"& p":{marginBottom:"15px",textAlign:"justify"},"& strong":{color:"#1976d2",fontWeight:"bold"}}}):e.jsxs(_,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",flexDirection:"column",color:"text.secondary"},children:[e.jsx(te,{variant:"h6",mb:2,children:"لا يوجد محتوى للعرض"}),e.jsx(te,{variant:"body2",children:"يرجى التأكد من وجود قالب العقد وبيانات العميل"})]})})},I.id))}),e.jsx(cn,{className:"no-print"}),e.jsxs(On,{className:"no-print",sx:{p:3,gap:2,flexDirection:"row-reverse",bgcolor:"#fafafa","@media print":{display:"none !important"}},children:[e.jsx(ze,{onClick:o,disabled:u,variant:"outlined",sx:{minWidth:"100px",borderColor:"grey.300",color:"text.secondary","&:hover":{borderColor:"grey.400",bgcolor:"grey.50"}},children:"إغلاق"}),e.jsx(ze,{variant:"outlined",startIcon:e.jsx($n,{sx:{marginLeft:"10px"}}),onClick:R,disabled:u||!z[j]?.html,sx:{minWidth:"120px",borderColor:"#1976d2",color:"#1976d2","&:hover":{borderColor:"#1565c0",bgcolor:"#e3f2fd"}},children:"طباعة"}),e.jsx(ze,{variant:"contained",startIcon:e.jsx(Ut,{sx:{marginLeft:"10px"}}),onClick:()=>m(z[j].id),disabled:u||!z[j]?.html,sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"},minWidth:"140px"},children:u?"جاري الحفظ...":"حفظ العقد"}),e.jsx(ze,{variant:"contained",startIcon:e.jsx(Ut,{sx:{marginLeft:"10px"}}),onClick:()=>m("both"),disabled:u||!s||!p,sx:{bgcolor:"#2e7d32","&:hover":{bgcolor:"#1b5e20"},minWidth:"180px"},children:u?"جاري الحفظ...":"حفظ كلا العقدين"})]})]})},Eo=()=>{const t=Mn(),[o,s]=d.useState(0),[p,m]=d.useState(null),[u,f]=d.useState(null),[S,j]=d.useState(null),[E,v]=d.useState(""),[R,z]=d.useState(""),[I,A]=d.useState(""),[H,P]=d.useState(1),[M,U]=d.useState(1),[F,ie]=d.useState(1),[ye,V]=d.useState(!1),[x,He]=d.useState({amount:"",interestRate:"",durationMonths:"",type:"",startDate:new Date().toISOString().split("T")[0],repaymentDay:""}),[ne,Me]=d.useState(null),[ce,l]=d.useState([]),[w,Ie]=d.useState(!1),[$,ae]=d.useState(!1),Ve=ln(),[It,Tt]=d.useState(!0),[Te,de]=d.useState(null),[X,ht]=d.useState(""),[st,oe]=d.useState(""),[G,Ee]=d.useState(0),[et,N]=d.useState(!1),[re,Ge]=d.useState({debtAck:"",promissoryNote:""}),[wt,Q]=d.useState(!1),Ke=d.useRef(null),tt=d.useRef(null),{data:K,isLoading:xt}=At({queryKey:["clients",H,E],queryFn:()=>po(H,E),enabled:o===1}),{data:g,isLoading:Ue}=At({queryKey:["banks",M,R],queryFn:()=>En(M,R),enabled:o===1}),{data:D,isLoading:ve}=At({queryKey:["partners",F,I],queryFn:()=>uo(F,I),enabled:o===1});d.useEffect(()=>{o===1&&(qe(),dt())},[o]);const qe=async()=>{try{console.log("Fetching contract templates...");const[a,c]=await Promise.all([me.get("/api/templates/DEBT_ACKNOWLEDGMENT"),me.get("/api/templates/PROMISSORY_NOTE")]);ht(a.data.content||""),oe(c.data.content||""),console.log("Templates fetched successfully")}catch(a){console.warn("Could not fetch contract templates:",a)}};d.useEffect(()=>{o===1&&dt()},[x.amount,x.interestRate,x.durationMonths,o]);const lt=Nt.debounce(a=>{v(a),P(1)},500),Ye=Nt.debounce(a=>{z(a),U(1)},500),we=Nt.debounce(a=>{A(a),ie(1)},500),Re=(a,c)=>{lt(c)},Ct=(a,c)=>{Ye(c)},Qe=(a,c)=>{we(c)},it=(a,c)=>{m(c)},q=(a,c)=>{f(c)},k=(a,c)=>{j(c)},Z=a=>a?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"",ct=async()=>{try{if(!p||!x.amount){J("يرجى ملء بيانات العميل والسلفة أولاً");return}const a={id:`preview-${Date.now()}`,amount:parseFloat(x.amount.replace(/,/g,"")),durationMonths:parseInt(x.durationMonths),startDate:x.startDate,client:p.client},c=await Ke.current.generateContract(!1,a),L=await tt.current.generateContract(!1,a);Ge({debtAck:c,promissoryNote:L}),N(!0)}catch(a){console.error("Error generating preview:",a),J("حدث خطأ أثناء توليد معاينة العقود")}},pe=async a=>{try{if(!Te){J("لم يتم إنشاء السلفة بعد. يرجى إنشاء السلفة أولاً");return}console.log("Saving contracts for loan:",Te.id),(a==="both"||a==="debt-acknowledgment")&&(console.log("Generating debt acknowledgment..."),await Ke.current?.generatePDF()),(a==="both"||a==="promissory-note")&&(console.log("Generating promissory note..."),await tt.current?.generatePDF()),ft("تم حفظ العقود بنجاح"),de(null),Ee(0),Ge({debtAck:"",promissoryNote:""}),N(!1),l([]),Ie(!1),ae(!1),s(0)}catch(c){console.error("Error saving contracts:",c),J("حدث خطأ أثناء حفظ العقود")}},dt=()=>{const a=parseFloat(x.amount.replace(/,/g,""))||0,c=parseFloat(x.interestRate)||0,L=parseInt(x.durationMonths)||0,se=x.type;if(a>0&&L>0){const Le=a*(c/100),We=a+Le,ke=se==="DAILY"?L*30:se==="WEEKLY"?L*4:L,he=We/ke,Be=a/ke,T=Le/ke,W=[];let Pe=We;for(let Oe=1;Oe<=ke;Oe++){const le=new Date(x.startDate);se==="DAILY"?le.setDate(le.getDate()+Oe):se==="WEEKLY"?le.setDate(le.getDate()+Oe*7):(le.setMonth(le.getMonth()+Oe),x.repaymentDay&&le.setDate(parseInt(x.repaymentDay))),Pe-=he,W.push({installmentNumber:Oe,dueDate:le,principal:Be,interest:T,installment:he,remainingBalance:Math.max(0,Pe),status:"PENDING",paidAmount:0})}l(W)}else l([])},Ce=()=>{if(ce.length===0)return null;const a=ce.reduce((se,Le)=>se+Le.interest,0),c=(parseFloat(x.amount.replace(/,/g,""))||0)+a;return{monthlyInstallment:ce[0]?.installment||0,totalInterest:a,totalAmount:c}},ue=async()=>{if(!p){J("يرجى اختيار عميل");return}try{Q(!0);const a={clientId:p.client.id,amount:parseFloat(x.amount.replace(/,/g,"")),interestRate:parseFloat(x.interestRate),durationMonths:parseInt(x.durationMonths),type:x.type,startDate:x.startDate,repaymentDay:parseInt(x.repaymentDay),bankAccountId:u?.id||null,partnerId:S?.id||null};console.log("Creating loan with data:",a);const c=await fo(a),L=c?.data?.loan||c?.loan;console.log("Loan created successfully:",L),ft("تم إنشاء السلفة بنجاح"),de({...L,client:p.client}),Ve.invalidateQueries(["loans"])}catch(a){console.error("Error creating loan:",a),J(a.response?.data?.message||"حدث خطأ أثناء إنشاء السلفة")}finally{Q(!1)}},nt=(a,c)=>{console.log(`Contract generated: ${c}`);const L=G+1;Ee(L)},pt=()=>{m(null),Me(null),f(null),j(null),He({amount:"",interestRate:"",durationMonths:"",type:"",startDate:new Date().toISOString().split("T")[0],repaymentDay:"10"}),l([]),Ie(!1),ae(!1),Ee(0),de(null),Q(!1)},ot=async()=>{if(!ne){J("لا يوجد سلفة محددة للتعديل");return}try{const a={amount:parseFloat(x.amount.replace(/,/g,"")),interestRate:parseFloat(x.interestRate),durationMonths:parseInt(x.durationMonths),type:x.type,startDate:x.startDate,repaymentDay:parseInt(x.repaymentDay),bankAccountId:u?.id||null,partnerId:S?.id||null};await go(ne.id,a),ft("تم تعديل السلفة بنجاح"),pt(),Ve.invalidateQueries(["loans"]),s(0)}catch(a){J(a.response?.data?.message||"حدث خطأ أثناء تعديل السلفة")}},Ae=async a=>{try{const c=await bo(a);Me(c),ae(!0),Ie(!1),c.client&&m({client:c.client}),c.bankAccount&&f(c.bankAccount),c.partner&&j(c.partner);const L=c.type==="DAILY"?c.durationMonths*30:c.type==="WEEKLY"?c.durationMonths*4:c.durationMonths,se=c.amount/L,Le=c.interestAmount/L;let We=c.totalAmount;const ke=c.repayments.map((he,Be)=>{const T={installmentNumber:Be+1,dueDate:he.dueDate,principal:se,interest:Le,installment:he.amount,remainingBalance:Math.max(0,We),status:he.status,paidAmount:he.paidAmount||0};return We-=he.amount,T});l(ke),He({amount:c.amount.toString(),interestRate:c.interestRate.toString(),durationMonths:c.durationMonths.toString(),type:c.type,startDate:c.startDate.split("T")[0],repaymentDay:c.repaymentDay?.toString()||"10"}),s(1)}catch(c){J(c.response?.data?.message||"حدث خطأ أثناء تحميل بيانات السلفة")}},Se=a=>{t(`/installments/${a.id}`)},Fe=()=>{if(ne.status!=="PENDING"){J("يمكن تعديل القروض في حالة 'قيد المراجعة' فقط");return}Ie(!0),ae(!1)},ee=(a,c)=>{if(a==="amount"){const L=c.replace(/,/g,"");isNaN(L)||(c=Z(L))}He(L=>({...L,[a]:c}))},je=()=>{w?ot():ue()},fe=Ce(),mt=()=>p&&x.amount&&x.interestRate&&x.durationMonths&&x.repaymentDay&&x.type,Ne=ne&&ne.status==="PENDING",ge=$&&ne&&ne.status!=="PENDING";return e.jsxs(_,{sx:{bgcolor:"#f6f6f8",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsxs(_,{sx:{display:"flex",flexDirection:"row-reverse",flex:1,height:"calc(100vh - 80px)",width:"100%"},children:[o===1&&e.jsxs(_,{sx:{width:"350px",borderRight:"1px solid #ddd",bgcolor:"#fafafa",height:"100%",overflowY:"auto",flexShrink:0},children:[e.jsxs(_,{sx:{p:3,borderBottom:"1px solid #ddd",bgcolor:"#fafafa"},children:[e.jsx(te,{variant:"h6",fontWeight:"bold",mb:3,children:"محاكاة السلفة"}),fe?e.jsxs(qt,{spacing:3,children:[e.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{color:"text.secondary",children:"القسط الشهري"}),e.jsxs(te,{color:"#0d40a5",fontWeight:"bold",fontSize:"20px",children:[Z(fe.monthlyInstallment.toFixed(2))," ","ر.س"]})]}),e.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{color:"text.secondary",children:"إجمالي الفائدة"}),e.jsxs(te,{color:"#333",fontSize:"16px",children:[Z(fe.totalInterest.toFixed(2))," ","ر.س"]})]}),e.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{color:"text.secondary",children:"المبلغ الإجمالي المستحق"}),e.jsxs(te,{color:"#333",fontSize:"16px",children:[Z(fe.totalAmount.toFixed(2))," ","ر.س"]})]}),e.jsx(cn,{}),e.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{color:"text.secondary",children:"حالة السلفة"}),e.jsx(zt,{label:$?"عرض":w?"تحت التعديل":"جديد",sx:{backgroundColor:$?"rgba(100, 100, 100, 0.2)":w?"rgba(214, 158, 46, 0.2)":"rgba(56, 161, 105, 0.2)",color:$?"#666":w?"#D69E2E":"#38A169",fontWeight:"bold"}})]})]}):e.jsx(Tn,{severity:"info",children:"أدخل بيانات السلفة لعرض المحاكاة"})]}),e.jsxs(_,{sx:{p:3},children:[e.jsx(te,{variant:"h6",fontWeight:"bold",mb:3,children:"الإجراءات"}),e.jsxs(qt,{spacing:2,children:[!$&&e.jsx(ze,{variant:"contained",onClick:je,disabled:!mt(),sx:{bgcolor:"#0d40a5",height:"48px",fontSize:"16px",fontWeight:"bold","&:hover":{bgcolor:"rgba(13, 64, 165, 0.9)"}},children:w?"حفظ التعديلات":"إنشاء السلفة"}),$&&Ne&&e.jsx(ze,{variant:"contained",onClick:Fe,sx:{bgcolor:"primary.main",height:"48px",fontSize:"16px",fontWeight:"bold","&:hover":{bgcolor:"primary.dark"}},children:"تعديل السلفة"}),e.jsx(ze,{variant:"outlined",onClick:ct,disabled:!Te,sx:{borderColor:"#0d40a5",color:"#0d40a5",height:"48px",fontSize:"16px",fontWeight:"bold","&:hover":{bgcolor:"rgba(13, 64, 165, 0.1)"}},children:"معاينة العقود"}),w&&e.jsx(ze,{variant:"outlined",onClick:()=>{Ie(!1),ae(!0)},sx:{borderColor:"rgba(255, 0, 0, 0.5)",color:"error.main",height:"48px",fontSize:"16px",fontWeight:"bold","&:hover":{bgcolor:"rgba(255, 0, 0, 0.1)"}},children:"إلغاء التعديل"})]})]})]}),e.jsx(_,{sx:{flex:1,p:4,bgcolor:"#fff",overflowY:"auto",width:"100%"},children:e.jsxs(_,{sx:{width:"100%"},children:[e.jsx(_,{sx:{borderBottom:1,borderColor:"divider",mb:4},children:e.jsxs(dn,{value:o,onChange:(a,c)=>{s(c),c===0&&pt()},children:[e.jsx(Ot,{label:"عرض جميع السلف",sx:{fontWeight:"bold",borderBottom:o===0?"3px solid #0d40a5":"none",color:o===0?"#0d40a5":"text.secondary"}}),e.jsx(Ot,{label:$?"عرض تفاصيل السلفة":w?"تعديل السلفة":"إنشاء سلفة جديدة",sx:{fontWeight:"bold",borderBottom:o===1?"3px solid #0d40a5":"none",color:o===1?"#0d40a5":"text.secondary"}})]})}),o===0?e.jsx(_,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:e.jsx(Io,{onViewDetails:Ae,onViewInstallments:Se})}):e.jsxs(_,{children:[e.jsxs(gt,{sx:{p:4,mb:3,borderRadius:2,border:"1px solid #e5e7eb"},children:[e.jsx(te,{variant:"h6",fontWeight:"bold",color:"#333",mb:3,textAlign:"center",children:"معلومات العميل"}),e.jsxs(xe,{container:!0,spacing:3,justifyContent:"center",children:[e.jsx(xe,{item:!0,xs:12,md:8,children:e.jsx(Wt,{options:K?.clients||[],getOptionLabel:a=>`${a.client.name} - ${a.client.nationalId}`,value:p,onChange:it,onInputChange:Re,loading:xt,disabled:$||w,renderInput:a=>e.jsx(_e,{...a,label:"اختر عميل حالي",placeholder:"ابحث بالاسم أو رقم الهوية",InputProps:{...a.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[xt?e.jsx(Lt,{color:"inherit",size:20}):null,a.InputProps.endAdornment]})},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"350px",backgroundColor:$||w?"#f5f5f5":"#f9fafb","&:hover fieldset":{borderColor:"#0d40a5"}}}})})}),e.jsx(xe,{item:!0,xs:12,md:4,sx:{display:"flex",alignItems:"end"},children:!$&&!w&&e.jsx(ze,{variant:"text",sx:{color:"#0d40a5",fontWeight:"bold",fontSize:"14px"},onClick:()=>V(!0),children:"أو إنشاء عميل جديد"})})]})]}),e.jsxs(gt,{sx:{p:4,mb:3,borderRadius:2,border:"1px solid #e5e7eb",backgroundColor:"#fff"},children:[e.jsx(te,{variant:"h6",fontWeight:"bold",color:"#333",mb:3,textAlign:"center",children:$?"تفاصيل السلفة":w?"تعديل تفاصيل السلفة":"حدد تفاصيل السلفة"}),e.jsxs(xe,{container:!0,spacing:3,justifyContent:"center",children:[e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(_e,{fullWidth:!0,type:"text",label:"مبلغ السلفة",value:Z(x.amount),onChange:a=>ee("amount",a.target.value),InputLabelProps:{shrink:!0},disabled:ge,onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(_e,{fullWidth:!0,type:"number",label:"معدل الفائدة السنوي (%)",value:x.interestRate,onChange:a=>ee("interestRate",a.target.value),InputLabelProps:{shrink:!0},disabled:ge,onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(_e,{fullWidth:!0,type:"number",label:"مدة السلفة (بالأشهر)",value:x.durationMonths,onChange:a=>ee("durationMonths",a.target.value),disabled:ge,onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(_e,{fullWidth:!0,type:"number",label:"عدد الأقساط",value:x.durationMonths,onChange:a=>ee("durationMonths",a.target.value),disabled:ge,onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsxs(_e,{fullWidth:!0,type:"text",label:"نوع السلفة",select:!0,value:x.type,onChange:a=>ee("type",a.target.value),disabled:ge,sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}},children:[e.jsx(Xe,{value:"DAILY",children:"يومي"}),e.jsx(Xe,{value:"WEEKLY",children:"أسبوعي"}),e.jsx(Xe,{value:"MONTHLY",children:"شهري"})]})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(_e,{fullWidth:!0,type:"number",label:"يوم السداد",value:x.repaymentDay,onChange:a=>ee("repaymentDay",a.target.value),inputProps:{min:1,max:31},disabled:ge,onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(Wt,{options:g?.data||[],getOptionLabel:a=>`${a.name} - ${a.accountNumber}`,value:u,onChange:q,onInputChange:Ct,loading:Ue,disabled:ge,renderInput:a=>e.jsx(_e,{...a,label:"اختر الحساب البنكي",placeholder:"ابحث باسم الحساب أو رقم الحساب",InputProps:{...a.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[Ue?e.jsx(Lt,{color:"inherit",size:20}):null,a.InputProps.endAdornment]})},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})})}),e.jsx(xe,{item:!0,xs:12,md:6,children:e.jsx(Wt,{options:D?.partners||[],getOptionLabel:a=>a.name,value:S,onChange:k,onInputChange:Qe,loading:ve,disabled:ge,renderInput:a=>e.jsx(_e,{...a,label:"اختر المستثمر",placeholder:"ابحث باسم المستثمر",InputProps:{...a.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[ve?e.jsx(Lt,{color:"inherit",size:20}):null,a.InputProps.endAdornment]})},sx:{"& .MuiOutlinedInput-root":{height:"56px",width:"250px",backgroundColor:$&&!w?"#f5f5f5":"#f9fafb"}}})})})]})]})]})]})})]}),e.jsx(Wn,{open:ye,onClose:()=>V(!1),onSuccess:()=>{V(!1),Ve.invalidateQueries(["clients"])}}),It&&Te&&p&&e.jsxs(e.Fragment,{children:[e.jsx(tn,{ref:Ke,loanData:Te,clientData:p?.client,templateContent:X,onContractGenerated:nt,contractType:"DEBT_ACKNOWLEDGMENT",autoGenerate:!1}),e.jsx(tn,{ref:tt,loanData:Te,clientData:p?.client,templateContent:st,onContractGenerated:nt,contractType:"PROMISSORY_NOTE",autoGenerate:!1}),e.jsx(Co,{open:et,onClose:()=>N(!1),debtAckHtml:re.debtAck,promissoryNoteHtml:re.promissoryNote,onSaveContracts:pe,loading:wt,clientName:p?.client?.name,loanAmount:parseFloat(x.amount.replace(/,/g,""))||0})]})]})};export{Eo as default};
//# sourceMappingURL=Loans-CIt4bjm-.js.map
