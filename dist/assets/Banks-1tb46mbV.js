import{r as f,az as V,aA as Y,aB as Z,j as e,D as J,y as ee,T as L,E as te,B as D,a as T,F as ne,d as O,C as _,n as z,e as K,G as re,K as ae,ap as se,P as oe,L as ie,N as le,O as ce,Q as k,R as h,U as ue,V as de,a9 as fe,I as $,X as ge}from"./index-2TEkS4Tk.js";import{u as he,c as xe,d as me,g as pe}from"./bankApis-C8Ta4s8G.js";import{D as be}from"./DeleteModal-CWdUgVUc.js";import{A as ye,S as je}from"./Search-Be34rJ9a.js";import{I as Se}from"./InputAdornment-BbJSv7Lk.js";import{E as Ce}from"./Edit-DJkzKNbs.js";import{T as Ne}from"./TablePagination-DstB3iTg.js";import"./KeyboardArrowRight-D-ZOxJ7W.js";import"./LastPage-TR1pquDU.js";const ve=(n,r,s,o)=>{const c=[s,{code:r,...o||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(c,"warn","react-i18next::",!0);A(c[0])&&(c[0]=`react-i18next:: ${c[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...c):console?.warn&&console.warn(...c)},F={},G=(n,r,s,o)=>{A(s)&&F[s]||(A(s)&&(F[s]=new Date),ve(n,r,s,o))},H=(n,r)=>()=>{if(n.isInitialized)r();else{const s=()=>{setTimeout(()=>{n.off("initialized",s)},0),r()};n.on("initialized",s)}},q=(n,r,s)=>{n.loadNamespaces(r,H(n,s))},M=(n,r,s,o)=>{if(A(s)&&(s=[s]),n.options.preload&&n.options.preload.indexOf(r)>-1)return q(n,s,o);s.forEach(c=>{n.options.ns.indexOf(c)<0&&n.options.ns.push(c)}),n.loadLanguages(r,H(n,o))},we=(n,r,s={})=>!r.languages||!r.languages.length?(G(r,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:r.languages}),!0):r.hasLoadedNamespace(n,{lng:s.lng,precheck:(o,c)=>{if(s.bindI18n&&s.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!c(o.isLanguageChangingTo,n))return!1}}),A=n=>typeof n=="string",Ie=n=>typeof n=="object"&&n!==null,Be=f.createContext();class Ae{constructor(){this.usedNamespaces={}}addUsedNamespaces(r){r.forEach(s=>{this.usedNamespaces[s]||(this.usedNamespaces[s]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var W={exports:{}},P={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U;function Ee(){if(U)return P;U=1;var n=V();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var s=typeof Object.is=="function"?Object.is:r,o=n.useState,c=n.useEffect,t=n.useLayoutEffect,x=n.useDebugValue;function N(u,d){var b=d(),C=o({inst:{value:b,getSnapshot:d}}),a=C[0].inst,y=C[1];return t(function(){a.value=b,a.getSnapshot=d,m(a)&&y({inst:a})},[u,b,d]),c(function(){return m(a)&&y({inst:a}),u(function(){m(a)&&y({inst:a})})},[u]),x(b),b}function m(u){var d=u.getSnapshot;u=u.value;try{var b=d();return!s(u,b)}catch{return!0}}function l(u,d){return d()}var S=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:N;return P.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:S,P}var Q;function Te(){return Q||(Q=1,W.exports=Ee()),W.exports}var ke=Te();const De=(n,r)=>A(r)?r:Ie(r)&&A(r.defaultValue)?r.defaultValue:Array.isArray(n)?n[n.length-1]:n,Re={t:De,ready:!1},We=()=>()=>{},Pe=(n,r={})=>{const{i18n:s}=r,{i18n:o,defaultNS:c}=f.useContext(Be)||{},t=s||o||Y();t&&!t.reportNamespaces&&(t.reportNamespaces=new Ae),t||G(t,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const x=f.useMemo(()=>({...Z(),...t?.options?.react,...r}),[t,r]),{useSuspense:N,keyPrefix:m}=x,l=f.useMemo(()=>{const g=c||t?.options?.defaultNS;return A(g)?[g]:g||["translation"]},[n,c,t]);t?.reportNamespaces?.addUsedNamespaces?.(l);const S=f.useRef(0),u=f.useCallback(g=>{if(!t)return We;const{bindI18n:p,bindI18nStore:I}=x,j=()=>{S.current+=1,g()};return p&&t.on(p,j),I&&t.store.on(I,j),()=>{p&&p.split(" ").forEach(E=>t.off(E,j)),I&&I.split(" ").forEach(E=>t.store.off(E,j))}},[t,x]),d=f.useRef(),b=f.useCallback(()=>{if(!t)return Re;const g=!!(t.isInitialized||t.initializedStoreOnce)&&l.every(B=>we(B,t,x)),p=r.lng||t.language,I=S.current,j=d.current;if(j&&j.ready===g&&j.lng===p&&j.keyPrefix===m&&j.revision===I)return j;const i={t:t.getFixedT(p,x.nsMode==="fallback"?l:l[0],m),ready:g,lng:p,keyPrefix:m,revision:I};return d.current=i,i},[t,l,m,x,r.lng]),[C,a]=f.useState(0),{t:y,ready:v}=ke.useSyncExternalStore(u,b,b);f.useEffect(()=>{if(t&&!v&&!N){const g=()=>a(p=>p+1);r.lng?M(t,r.lng,l,g):q(t,l,g)}},[t,r.lng,l,v,N,C]);const w=t||{},R=f.useMemo(()=>{const g=[y,w,v];return g.t=y,g.i18n=w,g.ready=v,g},[y,w,v]);if(t&&N&&!v)throw new Promise(g=>{const p=()=>g();r.lng?M(t,r.lng,l,p):q(t,l,p)});return R},Le=({open:n,onClose:r,onSuccess:s,bank:o,isEditMode:c=!1})=>{const[t,x]=f.useState({name:"",accountNumber:"",IBAN:"",limit:"",owner:""}),[N,m]=f.useState(!1),[l,S]=f.useState({});f.useEffect(()=>{x(o&&c?{name:o.name||"",accountNumber:o.accountNumber||"",IBAN:o.IBAN||"",limit:parseInt(o.limit)||"",owner:o.owner||""}:{name:"",accountNumber:"",IBAN:"",limit:"",owner:""}),S({})},[o,c,n]);const u=a=>y=>{const v=y.target.value;x(w=>({...w,[a]:v})),l[a]&&S(w=>({...w,[a]:""}))},d=()=>{const a={};return t.name.trim()||(a.name="اسم الحساب مطلوب"),t.accountNumber.trim()?/^\d+$/.test(t.accountNumber)?(t.accountNumber.length<10||t.accountNumber.length>14)&&(a.accountNumber="رقم الحساب يجب أن يكون بين 10 و 14 رقم"):a.accountNumber="رقم الحساب يجب أن يحتوي على أرقام فقط":a.accountNumber="رقم الحساب مطلوب",t.IBAN.trim()?/^[A-Za-z0-9]+$/.test(t.IBAN)?t.IBAN.length>24&&(a.IBAN="IBAN يجب أن يكون 24 حرف/رقم"):a.IBAN="IBAN يجب أن يحتوي على أحرف وأرقام فقط":a.IBAN="IBAN مطلوب",S(a),Object.keys(a).length===0},b=async()=>{if(d()){m(!0);try{c&&o?(await he(o.id,{...t,limit:parseInt(t.limit)}),z("تم تعديل الحساب البنكي بنجاح")):(await xe({...t,limit:parseInt(t.limit)}),z("تم إضافة الحساب البنكي بنجاح")),s()}catch(a){K(a.response?.data?.message||`حدث خطأ أثناء ${c?"تعديل":"إضافة"} الحساب البنكي`)}finally{m(!1)}}},C=()=>{x({name:"",accountNumber:"",IBAN:"",limit:"",owner:""}),S({}),r()};return e.jsxs(J,{open:n,onClose:C,maxWidth:"sm",fullWidth:!0,dir:"rtl",children:[e.jsx(ee,{sx:{pb:1},children:e.jsx(L,{variant:"h6",fontWeight:"bold",children:c?"تعديل حساب بنكي":"إضافة حساب بنكي جديد"})}),e.jsx(te,{sx:{py:3},children:e.jsxs(D,{children:[e.jsx(T,{label:"اسم الحساب",value:t.name,onChange:u("name"),fullWidth:!0,error:!!l.name,helperText:l.name,required:!0,sx:{mb:2,mt:2}}),e.jsx(T,{label:"اسم المالك",type:"text",value:t.owner,onChange:u("owner"),fullWidth:!0,error:!!l.owner,helperText:l.owner,required:!0,sx:{mb:2,mt:2}}),e.jsx(T,{label:"رقم الحساب",type:"text",value:t.accountNumber,onChange:u("accountNumber"),fullWidth:!0,error:!!l.accountNumber,helperText:l.accountNumber,required:!0,sx:{mb:2,mt:2},inputProps:{inputMode:"text",maxLength:14,min:0,max:14},onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()}}),e.jsx(T,{label:"رقم الايبان",type:"text",value:t.IBAN,onChange:u("IBAN"),fullWidth:!0,error:!!l.IBAN,helperText:l.IBAN,required:!0,sx:{mb:2,mt:2},inputProps:{inputMode:"text",maxLength:24,min:0,max:24},onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()}}),e.jsx(T,{label:" السلف المسموح بها للحساب البنكي",type:"number",value:t.limit,onChange:u("limit"),fullWidth:!0,error:!!l.limit,helperText:l.limit,required:!0,sx:{mb:2,mt:2},inputProps:{inputMode:"numeric",min:0},onKeyDown:a=>{(a.key==="-"||a.key==="+")&&a.preventDefault()}})]})}),e.jsxs(ne,{sx:{p:3,gap:1,flexDirection:"row-reverse"},children:[e.jsx(O,{onClick:C,disabled:N,variant:"outlined",sx:{minWidth:"100px",borderColor:"grey.300",color:"text.secondary","&:hover":{borderColor:"grey.400",bgcolor:"grey.50"}},children:"إلغاء"}),e.jsx(O,{variant:"contained",onClick:b,disabled:N,sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"},minWidth:"100px"},children:N?e.jsx(_,{size:24,color:"inherit"}):c?"تعديل":"إضافة"})]})]})},Ke=()=>{const{i18n:n}=Pe(),[r,s]=f.useState(1),[o,c]=f.useState(""),[t,x]=f.useState(null),[N,m]=f.useState(!1),[l,S]=f.useState(!1),[u,d]=f.useState(null),[b,C]=f.useState(!1),a=re(),{data:y,isLoading:v}=ae({queryKey:["banks",r,o],queryFn:()=>pe(r,o),retry:1}),w=i=>{c(i.target.value),s(1)},R=(i,B)=>{s(B+1)},g=async i=>{try{await me(i),z("تم حذف الحساب البنكي بنجاح"),a.invalidateQueries(["banks"]),m(!1),x(null)}catch(B){K(B.response?.data?.message||"حدث خطأ أثناء حذف الحساب البنكي")}},p=i=>{d(i),C(!0),S(!0)},I=()=>{d(null),C(!1),S(!0)},j=()=>{S(!1),d(null),C(!1)},E=()=>{j(),a.invalidateQueries(["banks"])};return e.jsxs(D,{sx:{bgcolor:"#f6f6f8",minHeight:"100vh",p:4},children:[e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(L,{variant:"h5",fontWeight:"bold",color:"#333",children:"الحسابات البنكية"}),e.jsx(O,{variant:"contained",startIcon:e.jsx(ye,{}),onClick:I,sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"},borderRadius:2,px:3,py:1,fontWeight:"bold"},children:"إضافة حساب بنكي"})]}),e.jsx(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:e.jsx(se,{placeholder:"ابحث باسم الحساب أو رقم الحساب...",value:o,onChange:w,InputProps:{startAdornment:e.jsx(Se,{position:"start",children:e.jsx(je,{})})},sx:{width:"300px",backgroundColor:"#f9fafb",borderRadius:"6px"}})}),e.jsxs(oe,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ie,{sx:{maxHeight:600},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(k,{children:[e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"#"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"اسم الحساب"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"اسم المالك"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"رقم الحساب"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"رقم الايبان"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"السلف المسموح بها"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"الحالة"}),e.jsx(h,{align:"center",sx:{fontWeight:"bold",backgroundColor:"#f8f9fa"},children:"الإجراءات"})]})}),e.jsx(ue,{children:v?e.jsx(k,{children:e.jsx(h,{colSpan:5,align:"center",children:e.jsx(_,{size:20})})}):y?.data?.length===0?e.jsx(k,{children:e.jsx(h,{colSpan:8,align:"center",children:e.jsx(L,{children:"لا توجد حسابات بنكية"})})}):y?.data?.map(i=>e.jsxs(k,{hover:!0,children:[e.jsx(h,{align:"center",children:i.id}),e.jsx(h,{align:"center",children:i.name}),e.jsx(h,{align:"center",children:i.owner}),e.jsx(h,{align:"center",children:i.accountNumber}),e.jsx(h,{align:"center",children:i.IBAN}),e.jsx(h,{align:"center",children:i.limit}),e.jsx(h,{align:"center",children:e.jsx(de,{label:n.language==="ar"?i.status==="Expired"?"منتهي":i.status==="Active"?"نشط":i.status:i.status,color:i.status==="Active"?"success":i.status==="Expired"?"warning":"",variant:"outlined",sx:{fontWeight:"bold",fontSize:"12px",padding:"4px 8px",borderRadius:"16px"}})}),e.jsx(h,{align:"center",children:e.jsxs(fe,{direction:"row",spacing:1,justifyContent:"center",alignItems:"center",children:[e.jsx($,{size:"small",color:"primary",onClick:()=>p(i),children:e.jsx(Ce,{fontSize:"small"})}),e.jsx($,{size:"small",color:"error",onClick:()=>{x(i),m(!0)},children:e.jsx(ge,{fontSize:"small"})})]})})]},i.id))})]})}),y&&e.jsx(Ne,{component:"div",count:y.total||0,page:r-1,onPageChange:R,rowsPerPage:10,rowsPerPageOptions:[10],labelDisplayedRows:({from:i,to:B,count:X})=>`عرض ${i}-${B} من ${X}`,labelRowsPerPage:"صفوف لكل صفحة:"})]}),e.jsx(be,{open:N,onClose:()=>{m(!1),x(null)},onConfirm:()=>g(t?.id),title:"حذف الحساب البنكي",message:`هل أنت متأكد من حذف الحساب البنكي ${t?.name}؟`,ButtonText:"حذف"}),e.jsx(Le,{open:l,onClose:j,onSuccess:E,bank:u,isEditMode:b})]})};export{Ke as default};
//# sourceMappingURL=Banks-1tb46mbV.js.map
