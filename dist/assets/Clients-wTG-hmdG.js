import{f as me,j as e,r as f,G as be,D as De,y as Se,T as a,I,z as we,E as Re,B as l,a1 as r,_ as Oe,F as Me,d as W,C as ne,a2 as Fe,P as j,a3 as se,a4 as ae,X as ie,a5 as ce,A,n as B,e as T,K as xe,a as x,V,a6 as he,h as X}from"./index-2TEkS4Tk.js";import{l as Pe}from"./lodash-CxsAddGS.js";import{A as Te}from"./AddClient-2kBVpEQJ.js";import{D as Ee}from"./DeleteModal-CWdUgVUc.js";import{F as je,P as Le,C as fe}from"./FileSaver.min-Pkg9k45W.js";import{A as ze,S as Ae}from"./Search-Be34rJ9a.js";import{I as $e}from"./InputAdornment-BbJSv7Lk.js";import{E as ue}from"./Edit-DJkzKNbs.js";import{S as pe}from"./Save-ue_qOb6O.js";import{T as qe,a as Z}from"./Tabs-BxNyk1aI.js";import"./index.esm-Q7QO3LVB.js";import"./LastPage-TR1pquDU.js";import"./KeyboardArrowRight-D-ZOxJ7W.js";const Ke=me(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),Be=me(e.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),Ue=({open:u,onClose:v,clientId:D,documents:m,hasKafeel:k=!1})=>{const[O,h]=f.useState(!1),[P,$]=f.useState({}),[E,q]=f.useState([]),L=be(),U=(o,d)=>{o.length>0&&$(b=>({...b,[d]:o[0]}))},N=o=>{$(d=>{const b={...d};return delete b[o],b})},s=o=>{q(d=>[...d,o])},K=o=>{q(d=>d.filter(b=>b!==o))},ee=o=>o.type.startsWith("image/")?URL.createObjectURL(o):null,_=async(o,d)=>{try{const F=await(await fetch(o)).blob();je.saveAs(F,d)}catch(b){console.error("Error downloading file:",b),T("حدث خطأ أثناء تحميل الملف")}},M=async o=>{try{window.open(o,"_blank")?.print()}catch(d){console.error("Error printing file:",d),T("حدث خطأ أثناء محاولة الطباعة")}},C=({fieldName:o,label:d,acceptedTypes:b,existingFile:F})=>{const{getRootProps:p,getInputProps:Q,isDragActive:G}=Fe({accept:b,onDrop:z=>U(z,o),multiple:!1}),n=P[o],Y=E.includes(o);if(F&&!Y&&!n){const z=F.split("/").pop();return e.jsx(j,{sx:{p:2},children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(a,{children:d}),e.jsxs(l,{children:[e.jsx(I,{onClick:()=>M(F),children:e.jsx(se,{})}),e.jsx(I,{onClick:()=>_(F,z),children:e.jsx(ae,{})}),e.jsx(I,{onClick:()=>s(o),color:"error",children:e.jsx(ie,{})})]})]})})}return Y&&!n?e.jsx(j,{sx:{p:2,bgcolor:"#fff5f5"},children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(a,{color:"error",children:[d," (سيتم الحذف)"]}),e.jsx(W,{onClick:()=>K(o),children:"تراجع"})]})}):e.jsxs(j,{...p(),sx:{p:3,border:"2px dashed",borderColor:G?"primary.main":"#ccc",textAlign:"center",bgcolor:G?"action.hover":"#fafafa",cursor:"pointer","&:hover":{borderColor:"primary.main",bgcolor:"action.hover"}},children:[e.jsx("input",{...Q()}),n?e.jsxs(l,{children:[n.type.startsWith("image/")?e.jsxs(l,{children:[e.jsx("img",{src:ee(n),alt:n.name,style:{maxWidth:"200px",maxHeight:120,marginBottom:8}}),e.jsx(a,{variant:"body2",children:n.name})]}):e.jsxs(l,{children:[e.jsx(ce,{sx:{fontSize:40,color:"primary.main",mb:1}}),e.jsx(a,{variant:"body2",children:n.name})]}),e.jsx(W,{startIcon:e.jsx(ie,{}),color:"error",size:"small",onClick:z=>{z.stopPropagation(),N(o)},sx:{mt:1},children:"إزالة"})]}):e.jsxs(l,{children:[e.jsx(ce,{sx:{fontSize:40,color:"#9e9e9e",mb:1}}),e.jsx(a,{variant:"body2",children:d}),e.jsx(a,{variant:"caption",color:"text.secondary",display:"block",mt:1,children:"اسحب وأفلت الملف هنا أو انقر للاختيار"})]})]})},g=async()=>{h(!0);try{const o=new FormData;Object.keys(P).forEach(d=>{o.append(d,P[d])}),E.length>0&&o.append("deleteFields",JSON.stringify(E)),await A.patch(`/api/clients/${D}/documents`,o,{headers:{"Content-Type":"multipart/form-data"}}),B("تم تحديث المستندات بنجاح"),v(),await L.invalidateQueries({queryKey:["clients"]}),await L.invalidateQueries({queryKey:["client-details",D]}),await L.refetchQueries({queryKey:["client-details",D]}),$({}),q([])}catch(o){console.error("Error updating documents:",o),T(o.response?.data?.message||"حدث خطأ أثناء تحديث المستندات")}finally{h(!1)}};return e.jsxs(De,{open:u,onClose:v,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2,direction:"rtl"}},children:[e.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsx(a,{variant:"h6",fontWeight:"bold",children:"تعديل المرفقات"}),e.jsx(I,{onClick:v,size:"small",children:e.jsx(we,{})})]}),e.jsxs(Re,{sx:{pb:1},children:[e.jsxs(l,{mb:4,children:[e.jsx(a,{variant:"h6",color:"primary",mb:2,mt:2,children:"مرفقات العميل"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"clientIdImage",label:"صورة هوية العميل",acceptedTypes:{"image/*":[".png",".jpg",".jpeg"]},existingFile:m?.clientIdImage})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"clientWorkCard",label:"بطاقة عمل العميل",acceptedTypes:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg"]},existingFile:m?.clientWorkCard})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"salaryReport",label:"تقرير الراتب",acceptedTypes:{"application/pdf":[".pdf"],"application/msword":[".doc",".docx"]},existingFile:m?.salaryReport})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"simaReport",label:"تقرير سمة",acceptedTypes:{"application/pdf":[".pdf"],"application/msword":[".doc",".docx"]},existingFile:m?.simaReport})})]})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx(Oe,{sx:{my:3}}),e.jsxs(l,{children:[e.jsx(a,{variant:"h6",color:"primary",mb:2,mt:2,children:"مرفقات الكفيل"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"kafeelIdImage",label:"صورة هوية الكفيل",acceptedTypes:{"image/*":[".png",".jpg",".jpeg"]},existingFile:m?.kafeelIdImage})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(C,{fieldName:"kafeelWorkCard",label:"بطاقة عمل الكفيل",acceptedTypes:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg"]},existingFile:m?.kafeelWorkCard})})]})]})]})]}),e.jsxs(Me,{sx:{px:3,py:2,gap:2},children:[e.jsx(W,{onClick:v,variant:"outlined",color:"inherit",disabled:O,children:"إلغاء"}),e.jsx(W,{onClick:g,variant:"contained",disabled:O&&Object.keys(P).length===0&&E.length===0,sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"},minWidth:120},children:O?e.jsx(ne,{size:24,color:"inherit"}):"حفظ التغييرات"})]})]})},Ne=async(u=1,v="",D="")=>{let m=new URLSearchParams;v.trim()&&(/^\d+$/.test(v.trim())?m.append("nationalId",v.trim()):m.append("name",v.trim())),D.trim()&&m.append("status",D.trim()),m.append("limit","10");const k=m.toString(),O=`/api/clients/all/${u}${k?`?${k}`:""}`;return(await A.get(O)).data},_e=async u=>(await A.get(`/api/clients/${u}`)).data;function it(){const[u,v]=f.useState(0),[D,m]=f.useState(""),[k,O]=f.useState(""),[h,P]=f.useState(null),[$,E]=f.useState(!1),[q,L]=f.useState(!1),[U,N]=f.useState(null),[s,K]=f.useState(!1),[ee,_]=f.useState(!1),[M,C]=f.useState(1),[g,o]=f.useState({}),[d,b]=f.useState({}),F=be(),{data:p,isLoading:Q,refetch:G}=xe({queryKey:["clients",M,D,k],queryFn:()=>Ne(M,D,k),retry:1}),{data:n}=xe({queryKey:["client-details",h?.id],queryFn:()=>h?_e(h.id):null,enabled:!!h,retry:1}),Y=Pe.debounce(t=>{m(t),C(1)},500),z=t=>{Y(t.target.value)},te=(t,i)=>{C(i)},ge=(t,i)=>{v(i)},ye=t=>{P(t),K(!1)},S=(t,i)=>{o(c=>({...c,[t]:i}))},w=(t,i)=>{b(c=>({...c,[t]:t==="salary"||t==="obligations"?parseFloat(i)||0:i}))},ve=async()=>{try{u===0?(await A.patch(`/api/clients/${h.id}/client-data`,g),B("تم تحديث بيانات العميل بنجاح")):u===2&&(await A.patch(`/api/clients/${h.id}/kafeel-data`,d),B("تم تحديث بيانات الكفيل بنجاح")),F.invalidateQueries({queryKey:["client-details",h.id]}),F.invalidateQueries({queryKey:["clients"]}),K(!1)}catch(t){T(t.response?.data?.message||"حدث خطأ أثناء تحديث البيانات"),X(t)}},Ce=()=>{E(!0)},ke=async t=>{try{await A.delete(`/api/clients/${t}`),B("تم حذف العميل بنجاح"),G(),h?.id===t&&P(null),L(!1),N(null)}catch(i){T(i.response?.data?.message||"حدث خطأ أثناء حذف العميل"),X(i)}},Ie=t=>{N(t),L(!0)},re=async(t,i,c,y)=>{try{const H=await(await fetch(t)).blob(),J=i.split(".").pop(),We=`${c}_${y}.${J}`;je.saveAs(H,We)}catch(R){T(R.response?.data?.message||"حدث خطأ أثناء تحميل الملف"),X(R)}},le=async t=>{try{const c=await(await fetch(t)).blob(),y=URL.createObjectURL(c),R=window.open(y,"_blank");R?.addEventListener("load",()=>{R.print(),R.addEventListener("afterprint",()=>{URL.revokeObjectURL(y)})},{once:!0})}catch(i){T(i.response?.data?.message||"حدث خطأ أثناء محاولة الطباعة"),X(i)}},oe=async(t,i,c)=>{try{const R=await(await fetch(t)).blob(),H=i+".pdf",J=new File([R],H,{type:R.type});navigator.canShare&&navigator.canShare({files:[J]})?await navigator.share({title:H,text:`مشاركة مستند: ${c}`,files:[J]}):(await navigator.clipboard.writeText(t),B("تم نسخ رابط الملف لأن المشاركة غير مدعومة"))}catch(y){console.error(y),T("حدث خطأ أثناء مشاركة الملف")}};f.useEffect(()=>{p?.clients?.length>0&&!h&&P(p.clients[0].client)},[p,h]),f.useEffect(()=>{n?.client&&o({name:n.client.name||"",phone:n.client.phone||"",city:n.client.city||"",district:n.client.district||"",address:n.client.address||"",employer:n.client.employer||"",creationReason:n.client.creationReason||"",notes:n.client.notes||"",birthDate:n.client.birthDate?new Date(n.client.birthDate).toISOString().split("T")[0]:""}),n?.kafeel&&b({name:n.kafeel.name||"",nationalId:n.kafeel.nationalId||"",birthDate:n.kafeel.birthDate?new Date(n.kafeel.birthDate).toISOString().split("T")[0]:"",city:n.kafeel.city||"",district:n.kafeel.district||"",employer:n.kafeel.employer||"",salary:n.kafeel.salary||"",obligations:n.kafeel.obligations||"",phone:n.kafeel.phone||"",email:n.kafeel.email||""})},[n]);const de=t=>{switch(t){case"ملتزم":return"success";case"متأخر":return"warning";case"متعثر":return"error";default:return"default"}};return e.jsxs(l,{sx:{bgcolor:"#f6f6f8",minHeight:"100vh"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,bgcolor:"#fff",borderBottom:"1px solid #ddd"},children:[e.jsx(a,{variant:"h5",fontWeight:"bold",children:"العملاء"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(ze,{sx:{marginLeft:"10px"}}),onClick:Ce,sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"},fontWeight:"bold",borderRadius:2,px:2.5,py:1},children:"إضافة عميل جديد"})]}),e.jsxs(l,{sx:{display:"flex",height:"calc(100vh - 80px)"},children:[e.jsxs(l,{sx:{width:"350px",borderRight:"1px solid #ddd",bgcolor:"#fafafa",height:"100%",overflowY:"auto",flexShrink:0},children:[e.jsxs(l,{sx:{p:3,borderBottom:"1px solid #ddd",bgcolor:"#fafafa"},children:[e.jsx(x,{placeholder:"البحث بالاسم أو رقم الهوية",fullWidth:!0,size:"small",onChange:z,InputProps:{startAdornment:e.jsx($e,{position:"start",children:e.jsx(Ae,{})})}}),e.jsxs(l,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:2},children:[e.jsx(V,{label:"ملتزم",color:k==="ملتزم"?"primary":"default",variant:"outlined",onClick:()=>{O(t=>t==="ملتزم"?"":"ملتزم"),C(1)}}),e.jsx(V,{label:"متأخر",color:k==="متأخر"?"primary":"default",variant:"outlined",onClick:()=>{O(t=>t==="متأخر"?"":"متأخر"),C(1)}}),e.jsx(V,{label:"متعثر",color:k==="متعثر"?"primary":"default",variant:"outlined",onClick:()=>{O(t=>t==="متعثر"?"":"متعثر"),C(1)}})]})]}),p&&!Q&&e.jsx(l,{sx:{p:2,borderBottom:"1px solid #eee",bgcolor:"#f9f9f9"},children:e.jsxs(a,{variant:"body2",color:"black",children:["صفحة ",p.currentPage," من ",p.totalPages," - إجمالي ",p.totalClients," عميل"]})}),Q?e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(ne,{})}):p?.clients?.length===0?e.jsxs(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,flexDirection:"column"},children:[e.jsx(a,{variant:"h6",color:"text.secondary",mb:1,children:"لا توجد عملاء"}),e.jsx(a,{variant:"body2",color:"black",children:D||k?"لم يتم العثور على عملاء مطابقين للبحث":"لا توجد عملاء مسجلين"})]}):p?.clients?.map(t=>{const i=t.client,c=h?.id===i.id;return e.jsxs(l,{sx:{p:2,borderBottom:"1px solid #eee",cursor:"pointer",bgcolor:c?"#e8efff":"inherit","&:hover":{bgcolor:"#f1f1f1"}},onClick:()=>ye(i),children:[e.jsx(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:e.jsxs(l,{children:[e.jsx(a,{fontWeight:"bold",color:c?"primary.main":"text.primary",children:i.name}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["رقم الهوية: ",i.nationalId]})]})}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1,children:[e.jsx(V,{label:i.status,size:"small",color:de(i.status),variant:"outlined"}),e.jsx(I,{size:"small",color:"error",onClick:y=>{y.stopPropagation(),Ie(i)},children:e.jsx(ie,{fontSize:"small"})})]})]},i.id)}),p&&p.totalPages>1&&e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderTop:"1px solid #eee",bgcolor:"#fafafa"},children:[e.jsx(W,{variant:"outlined",size:"small",startIcon:e.jsx(Be,{}),disabled:M===1,onClick:()=>te(null,M-1),sx:{minWidth:"80px","&:disabled":{opacity:.5}},children:"السابق"}),e.jsx(Le,{count:p.totalPages,page:M,onChange:te,color:"primary",size:"small",siblingCount:1,boundaryCount:1,sx:{"& .MuiPaginationItem-root":{fontSize:"0.875rem"}}}),e.jsx(W,{variant:"outlined",size:"small",endIcon:e.jsx(Ke,{}),disabled:M===p.totalPages,onClick:()=>te(null,M+1),sx:{minWidth:"80px","&:disabled":{opacity:.5}},children:"التالي"})]})]}),h&&n?e.jsxs(l,{sx:{flex:1,p:4,bgcolor:"#fff",overflowY:"auto"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"h6",fontWeight:"bold",children:n.client.name}),e.jsxs(a,{color:"text.secondary",children:["رقم الهوية: ",n.client.nationalId]})]}),u!==1&&e.jsx(l,{sx:{display:"flex",gap:2},children:u===3?e.jsxs(e.Fragment,{children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(ue,{sx:{marginLeft:"10px"}}),onClick:()=>_(!0),children:"تعديل"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(pe,{sx:{marginLeft:"10px"}}),sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"}},disabled:!s,children:"حفظ التغييرات"})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(ue,{sx:{marginLeft:"10px"}}),onClick:()=>K(!s),children:s?"إلغاء التعديل":"تعديل"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(pe,{sx:{marginLeft:"10px"}}),sx:{bgcolor:"#0d40a5","&:hover":{bgcolor:"#0b3589"}},disabled:!s,onClick:ve,children:"حفظ التغييرات"})]})})]}),e.jsxs(qe,{value:u,onChange:ge,textColor:"primary",indicatorColor:"primary",sx:{mb:3},children:[e.jsx(Z,{label:"الملف الشخصي"}),e.jsx(Z,{label:"المعلومات المالية"}),e.jsx(Z,{label:"الكفيل"}),e.jsx(Z,{label:"المرفقات"})]}),u===0&&e.jsxs(l,{children:[e.jsxs(j,{sx:{p:3,mb:3},children:[e.jsx(a,{variant:"h6",mb:3,children:"المعلومات الشخصية"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"الاسم الكامل"}),e.jsx(x,{value:s?g.name:n.client.name,onChange:t=>S("name",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px",width:"280px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"البريد الإلكتروني"}),e.jsx(x,{value:s?g.email:n.client.email||"لا يوجد بريد إلكتروني",onChange:t=>S("email",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"رقم الهوية الوطنية"}),e.jsx(x,{value:n.client.nationalId,fullWidth:!0,disabled:!0,sx:{"& .MuiOutlinedInput-root":{backgroundColor:"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"رقم الجوال"}),e.jsx(x,{value:s?g.phone:n.client.phone,onChange:t=>S("phone",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"تاريخ الميلاد"}),e.jsx(x,{value:s?g.birthDate:n.client.birthDate?new Date(n.client.birthDate).toISOString().split("T")[0]:"",onChange:t=>S("birthDate",t.target.value),fullWidth:!0,type:"date",disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"المدينة"}),e.jsx(x,{value:s?g.city:n.client.city,onChange:t=>S("city",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"الحي"}),e.jsx(x,{value:s?g.district:n.client.district,onChange:t=>S("district",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px",width:"280px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"العنوان التفصيلي"}),e.jsx(x,{value:s?g.address:n.client.address||"",onChange:t=>S("address",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px",width:"350px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"جهة العمل"}),e.jsx(x,{value:s?g.employer:n.client.employer,onChange:t=>S("employer",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"سبب الإنشاء"}),e.jsx(x,{value:s?g.creationReason:n.client.creationReason||"",onChange:t=>S("creationReason",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]})]})]}),e.jsxs(j,{sx:{p:3,mt:3},children:[e.jsx(a,{variant:"h6",mb:3,children:"ملاحظات"}),e.jsx(x,{value:s?g.notes:n.client.notes||"",onChange:t=>S("notes",t.target.value),fullWidth:!0,multiline:!0,rows:3,disabled:!s,placeholder:"لا توجد ملاحظات",sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px","&:hover fieldset":{borderColor:"#0d40a5"}}}})]})]}),u===1&&e.jsxs(j,{sx:{p:3},children:[e.jsx(a,{variant:"h6",mb:3,children:"المعلومات المالية"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(j,{sx:{p:3,bgcolor:"#f8f9fa"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",mb:1,children:"الراتب"}),e.jsxs(a,{variant:"h5",fontWeight:"bold",color:"primary",children:[n.client.salary?.toLocaleString()," ريال"]})]})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(j,{sx:{p:3,bgcolor:"#f8f9fa"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",mb:1,children:"الالتزامات"}),e.jsxs(a,{variant:"h5",fontWeight:"bold",color:"error",children:[n.client.obligations?.toLocaleString()," ","ريال"]})]})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(j,{sx:{p:3,bgcolor:"#f8f9fa"},children:[e.jsx(a,{variant:"body1",color:"text.secondary",mb:1,children:"الحالة"}),e.jsx(a,{variant:"h5",fontWeight:"bold",color:de(n.client.status),children:n.client.status})]})})]})]}),u===2&&e.jsxs(j,{sx:{p:3},children:[e.jsx(a,{variant:"h6",mb:3,children:"معلومات الكفيل"}),n.kafeel?e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"اسم الكفيل"}),e.jsx(x,{value:s?d.name:n.kafeel.name,onChange:t=>w("name",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"رقم هوية الكفيل"}),e.jsx(x,{value:s?d.nationalId:n.kafeel.nationalId,onChange:t=>w("nationalId",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"تاريخ الميلاد"}),e.jsx(x,{value:s?d.birthDate:n.kafeel.birthDate?new Date(n.kafeel.birthDate).toISOString().split("T")[0]:"",onChange:t=>w("birthDate",t.target.value),fullWidth:!0,type:"date",disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"المدينة"}),e.jsx(x,{value:s?d.city:n.kafeel.city,onChange:t=>w("city",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"الحي"}),e.jsx(x,{value:s?d.district:n.kafeel.district,onChange:t=>w("district",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"رقم الجوال"}),e.jsx(x,{value:s?d.phone:n.kafeel.phone,onChange:t=>w("phone",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"البريد الإلكتروني"}),e.jsx(x,{value:s?d.email:n.kafeel.email,onChange:t=>w("email",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"جهة العمل"}),e.jsx(x,{value:s?d.employer:n.kafeel.employer,onChange:t=>w("employer",t.target.value),fullWidth:!0,disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"الراتب"}),e.jsx(x,{value:s?d.salary:n.kafeel.salary,onChange:t=>w("salary",t.target.value),fullWidth:!0,type:"number",disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",mb:1,fontWeight:500,children:"الالتزامات"}),e.jsx(x,{value:s?d.obligations:n.kafeel.obligations,onChange:t=>w("obligations",t.target.value),fullWidth:!0,type:"number",disabled:!s,sx:{"& .MuiOutlinedInput-root":{backgroundColor:s?"#fff":"#f9fafb",borderRadius:"6px"}}})]})]}):e.jsx(a,{variant:"body1",color:"text.secondary",align:"center",children:"لا يوجد كفيل لهذا العميل"})]}),u===3&&e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(a,{variant:"h5",sx:{mb:2,color:"primary.main"},children:"مستندات العميل"}),n.documents&&n.documents.length>0?e.jsx(r,{container:!0,spacing:2,children:Object.entries(n.documents[0]).map(([t,i])=>{const c={clientIdImage:"صورة هوية العميل",clientWorkCard:"بطاقة عمل العميل",salaryReport:"تقرير الراتب",simaReport:"تقرير SIMA",DEBT_ACKNOWLEDGMENT:"إقرار الدين",PROMISSORY_NOTE:"سند الأمر"};return i&&c[t]?e.jsx(r,{item:!0,xs:12,children:e.jsxs(j,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(fe,{color:"success",fontSize:"small"}),e.jsx(l,{children:e.jsx(a,{fontWeight:"500",children:c[t]})})]}),e.jsxs(l,{children:[e.jsx(I,{onClick:()=>le(i),children:e.jsx(se,{})}),e.jsx(I,{onClick:()=>re(i,"",c[t],n.client.name),children:e.jsx(ae,{})}),e.jsx(I,{onClick:y=>{y.stopPropagation(),oe(i,c[t],n.client.name)},title:"مشاركة",children:e.jsx(he,{})})]})]})},t):null})}):e.jsx(j,{sx:{p:3,textAlign:"center",mb:3},children:e.jsx(a,{color:"text.secondary",children:"لا توجد مستندات للعميل"})})]}),n.kafeel&&e.jsxs(l,{sx:{mt:5,mb:3},children:[e.jsx(a,{variant:"h5",sx:{mt:5,mb:2,color:"primary.main"},children:"مستندات الكفيل"}),n.documents&&n.documents.length>0?e.jsx(r,{container:!0,spacing:2,children:Object.entries(n.documents[0]).map(([t,i])=>{const c={kafeelIdImage:"صورة هوية الكفيل",kafeelWorkCard:"بطاقة عمل الكفيل"};return i&&c[t]?e.jsx(r,{item:!0,xs:12,children:e.jsxs(j,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(fe,{color:"success",fontSize:"small"}),e.jsx(l,{children:e.jsx(a,{fontWeight:"500",children:c[t]})})]}),e.jsxs(l,{children:[e.jsx(I,{onClick:()=>le(i),children:e.jsx(se,{})}),e.jsx(I,{onClick:()=>re(i,"",c[t],n.client.name),children:e.jsx(ae,{})}),e.jsx(I,{onClick:y=>{y.stopPropagation(),oe(i,c[t],n.client.name)},title:"مشاركة",children:e.jsx(he,{})})]})]})},t):null})}):e.jsx(j,{sx:{p:3,textAlign:"center"},children:e.jsx(a,{color:"text.secondary",children:"لا توجد مستندات للكفيل"})})]})]})]}):e.jsxs(l,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:2},children:[e.jsx(a,{variant:"h6",color:"text.secondary",children:h?"جاري تحميل البيانات...":"اختر عميلاً لعرض التفاصيل"}),h&&e.jsx(ne,{size:40})]})]}),e.jsx(Te,{open:$,onClose:()=>E(!1)}),e.jsx(Ee,{open:q,onClose:()=>L(!1),onConfirm:()=>ke(U?.id),title:"حذف العميل",message:`هل أنت متأكد من حذف العميل ${U?.name}؟`,ButtonText:"حذف"}),e.jsx(Ue,{open:ee,onClose:()=>_(!1),clientId:h?.id,documents:n?.documents?.[0],hasKafeel:!!n?.kafeel})]})}export{it as default};
//# sourceMappingURL=Clients-wTG-hmdG.js.map
