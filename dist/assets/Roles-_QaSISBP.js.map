{"version":3,"file":"Roles-_QaSISBP.js","sources":["../../src/components/modals/AddRole.jsx","../../src/pages/Roles/Roles.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Box,\n  IconButton,\n  FormControlLabel,\n  Checkbox,\n  Typography,\n  Divider,\n  CircularProgress\n} from '@mui/material';\nimport { Close as CloseIcon } from '@mui/icons-material';\nimport { Formik, Form } from 'formik';\nimport * as Yup from 'yup';\nimport Api from '../../config/Api';\nimport { notifySuccess, notifyError } from '../../utilities/toastify';\nimport { getAvailableModules } from '../../routes';\nimport { useQueryClient } from '@tanstack/react-query';\n\nconst validationSchema = Yup.object().shape({\n  name: Yup.string()\n    .required('اسم الدور مطلوب')\n    .min(2, 'اسم الدور يجب أن يكون حرفين على الأقل'),\n  description: Yup.string()\n    .required('وصف الدور مطلوب')\n    .min(5, 'الوصف يجب أن يكون 5 أحرف على الأقل'),\n  permissions: Yup.array().of(\n    Yup.object().shape({\n      module: Yup.string().required(),\n      canView: Yup.boolean(),\n      canAdd: Yup.boolean(),\n      canUpdate: Yup.boolean(),\n      canDelete: Yup.boolean(),\n    })\n  )\n});\n\n// Get available modules dynamically from routes\nconst availableModules = getAvailableModules();\nconst AddRole = ({ open, onClose, refetchRoles, mode = 'add', editData = null }) => {\n  const queryClient = useQueryClient();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [initialValues, setInitialValues] = useState({\n    name: '',\n    description: '',\n    permissions: availableModules.map(module => ({\n      module: module.value,\n      canView: false,\n      canAdd: false,\n      canUpdate: false,\n      canDelete: false\n    }))\n  });\n\n  useEffect(() => {\n    if (mode === 'edit' && editData) {\n      const formattedPermissions = availableModules.map(module => {\n        const existingPermission = editData.permissions?.find(p => p.module === module.value);\n        return {\n          module: module.value,\n          canView: existingPermission?.canView || false,\n          canAdd: existingPermission?.canAdd || false,\n          canUpdate: existingPermission?.canUpdate || false,\n          canDelete: existingPermission?.canDelete || false\n        };\n      });\n\n      setInitialValues({\n        name: editData.name || '',\n        description: editData.description || '',\n        permissions: formattedPermissions\n      });\n    } else {\n      // Reset to initial values for add mode\n      setInitialValues({\n        name: '',\n        description: '',\n        permissions: availableModules.map(module => ({\n          module: module.value,\n          canView: false,\n          canAdd: false,\n          canUpdate: false,\n          canDelete: false\n        }))\n      });\n    }\n  }, [mode, editData, open]);\n\n  const handleSubmit = async (values, { resetForm }) => {\n    setIsSubmitting(true);\n    try {\n      const payload = {\n        name: values.name,\n        description: values.description,\n        permissions: values.permissions\n      };\n\n      if (mode === 'add') {\n        await Api.post('/api/roles', payload);\n        notifySuccess('تم إضافة الدور بنجاح');\n        queryClient.invalidateQueries({ queryKey: ['roles'] });\n        queryClient.invalidateQueries({ queryKey: ['employees'] });\n      } else {\n        await Api.patch(`/api/roles/${editData.id}`, payload);\n        notifySuccess('تم تعديل الدور بنجاح');\n        queryClient.invalidateQueries({ queryKey: ['roles'] });\n        queryClient.invalidateQueries({ queryKey: ['employees'] });\n      }\n      \n      resetForm();\n      refetchRoles();\n      onClose();\n    } catch (error) {\n      notifyError(error.response?.data?.message || 'حدث خطأ أثناء العملية');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handlePermissionChange = (values, setFieldValue, moduleIndex, field, value) => {\n    const updatedPermissions = [...values.permissions];\n    updatedPermissions[moduleIndex] = {\n      ...updatedPermissions[moduleIndex],\n      [field]: value\n    };\n    setFieldValue('permissions', updatedPermissions);\n  };\n\n  const handleSelectAll = (values, setFieldValue, field, value) => {\n    const updatedPermissions = values.permissions.map(permission => ({\n      ...permission,\n      [field]: value\n    }));\n    setFieldValue('permissions', updatedPermissions);\n  };\n\n  return (\n    <Dialog \n      open={open} \n      onClose={onClose}\n      maxWidth=\"sm\"\n      fullWidth\n      PaperProps={{\n        sx: {\n          borderRadius: 2,\n          direction: 'rtl'\n        }\n      }}\n    >\n      <DialogTitle sx={{ \n        display: 'flex', \n        justifyContent: 'space-between', \n        alignItems: 'center',\n        pb: 1\n      }}>\n        {mode === 'add' ? 'إضافة دور جديد' : 'تعديل الدور'}\n        <IconButton onClick={onClose} size=\"small\">\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n\n      <Formik\n        initialValues={initialValues}\n        validationSchema={validationSchema}\n        onSubmit={handleSubmit}\n        enableReinitialize\n      >\n        {({ values, errors, touched, handleChange, handleBlur, setFieldValue }) => (\n          <Form>\n            <DialogContent sx={{ pb: 1 }}>\n              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3 }}>\n                {/* Role Name and Description */}\n                <Box sx={{ display: 'flex', gap: 2, flexWrap: 'wrap' }}>\n                  <TextField\n                    name=\"name\"\n                    label=\"اسم الدور\"\n                    value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    error={touched.name && Boolean(errors.name)}\n                    helperText={touched.name && errors.name}\n                    sx={{ \n                      minWidth: 250,\n                      '& .MuiOutlinedInput-root': {\n                        backgroundColor: '#f9fafb',\n                        borderRadius: '6px',\n                        '&:hover fieldset': {\n                          borderColor: '#0d40a5',\n                        },\n                      },\n                      '& .MuiOutlinedInput-input': {\n                        fontSize: '0.875rem',\n                      }\n                    }}\n                  />\n                  \n                  <TextField\n                    name=\"description\"\n                    label=\"وصف الدور\"\n                    value={values.description}\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    error={touched.description && Boolean(errors.description)}\n                    helperText={touched.description && errors.description}\n                    sx={{ \n                      minWidth: 250,\n                      '& .MuiOutlinedInput-root': {\n                        backgroundColor: '#f9fafb',\n                        borderRadius: '6px',\n                        '&:hover fieldset': {\n                          borderColor: '#0d40a5',\n                        },\n                      },\n                      '& .MuiOutlinedInput-input': {\n                        fontSize: '0.875rem',\n                      },\n                    }}\n                  />\n                </Box>\n                <Divider />\n\n                {/* Permissions Section */}\n                <Box>\n                  <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 'bold' }}>\n                    الصلاحيات\n                  </Typography>\n                  \n                  {/* Header with Select All checkboxes */}\n                  <Box sx={{ \n                    display: 'grid', \n                    gridTemplateColumns: '1fr repeat(4, auto)',\n                    gap: 1,\n                    alignItems: 'center',\n                    mb: 2,\n                    p: 1,\n                    bgcolor: '#f5f5f5',\n                    borderRadius: 1\n                  }}>\n                    <Typography variant=\"subtitle2\" sx={{ fontWeight: 'bold' }}>\n                      الصلاحيات\n                    </Typography>\n                    {['عرض', 'إضافة', 'تعديل', 'حذف'].map((action, index) => (\n                      <Box key={action} sx={{ textAlign: 'center' }}>\n                        <Typography variant=\"subtitle2\" sx={{ fontSize: '0.75rem', fontWeight: 'bold' }}>\n                          {action}\n                        </Typography>\n                        <Checkbox\n                          size=\"small\"\n                          onChange={(e) => handleSelectAll(\n                            values, \n                            setFieldValue, \n                            ['canView', 'canAdd', 'canUpdate', 'canDelete'][index], \n                            e.target.checked\n                          )}\n                        />\n                      </Box>\n                    ))}\n                  </Box>\n\n                  {/* Permissions List */}\n                  <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n                    {values.permissions.map((permission, index) => {\n                      const moduleConfig = availableModules.find(m => m.value === permission.module);\n                      return (\n                        <Box\n                          key={permission.module}\n                          sx={{\n                            display: 'grid',\n                            gridTemplateColumns: '1fr repeat(4, auto)',\n                            gap: 1,\n                            alignItems: 'center',\n                            p: 1,\n                            borderRadius: 1,\n                            bgcolor: index % 2 === 0 ? 'transparent' : '#f9f9f9'\n                          }}\n                        >\n                          <Typography variant=\"body2\" sx={{ fontWeight: '500' }}>\n                            {moduleConfig?.label || permission.module}\n                          </Typography>\n                          \n                          {['canView', 'canAdd', 'canUpdate', 'canDelete'].map((field) => (\n                            <Box key={field} sx={{ display: 'flex', justifyContent: 'center' }}>\n                              <FormControlLabel\n                                control={\n                                  <Checkbox\n                                    size=\"small\"\n                                    checked={permission[field]}\n                                    onChange={(e) => handlePermissionChange(\n                                      values, \n                                      setFieldValue, \n                                      index, \n                                      field, \n                                      e.target.checked\n                                    )}\n                                  />\n                                }\n                                label=\"\"\n                              />\n                            </Box>\n                          ))}\n                        </Box>\n                      );\n                    })}\n                  </Box>\n                </Box>\n              </Box>\n            </DialogContent>\n\n            <DialogActions sx={{ \n              px: 3, \n              py: 2, \n              display: 'flex', \n              justifyContent: 'center', \n              alignItems: 'center', \n              gap: 2,\n              flexDirection: 'row-reverse' \n            }}>\n              <Button \n                onClick={onClose}\n                variant=\"outlined\"\n                color=\"inherit\"\n                disabled={isSubmitting}\n              >\n                إلغاء\n              </Button>\n              <Button\n                type=\"submit\"\n                variant=\"contained\"\n                disabled={isSubmitting}\n                sx={{\n                  bgcolor: \"#1E40AF\",\n                  \"&:hover\": { bgcolor: \"#1E3A8A\" },\n                  minWidth: 120\n                }}\n              >\n                {isSubmitting ? (\n                  <CircularProgress size={24} color=\"inherit\" />\n                ) : (\n                  mode === 'add' ? 'إضافة' : 'تعديل'\n                )}\n              </Button>\n            </DialogActions>\n          </Form>\n        )}\n      </Formik>\n    </Dialog>\n  );\n};\n\nexport default AddRole;","import React, { useState } from \"react\";\nimport {\n  Box,\n  Button,\n  IconButton,\n  TextField,\n  InputAdornment,\n  TableContainer,\n  TableHead,\n  TableBody,\n  Paper,\n  Chip,\n  Table,\n  TablePagination,\n  CircularProgress,\n} from \"@mui/material\";\nimport {\n  Add,\n  Search,\n  Edit,\n  Delete,\n} from \"@mui/icons-material\";\nimport { StyledTableCell, StyledTableRow } from '../../components/layouts/tableLayout';\nimport Api from \"../../config/Api\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport dayjs from \"dayjs\";\nimport AddRole from \"../../components/modals/AddRole\";\nimport DeleteModal from \"../../components/modals/DeleteModal\";\nimport { debounce } from 'lodash';\nimport { usePermissions } from \"../../components/Contexts/PermissionsContext\";\n// eslint-disable-next-line no-unused-vars\nconst getRoles = async (page = 1, name = '') => {\n  const response = await Api.get(`/api/roles?name=${name}`);\n  return response.data;\n};\n\nexport default function Roles() {\n  const [page, setPage] = useState(0);\n  const [rowsPerPage, setRowsPerPage] = useState(10);\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\n  const [editMode, setEditMode] = useState('add');\n  const [selectedRole, setSelectedRole] = useState(null);\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [selectedRoleId, setSelectedRoleId] = useState(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const { permissions } = usePermissions();\n  const { data: rolesData, isLoading, refetch } = useQuery({ \n    queryKey: [\"roles\", page + 1, searchQuery], \n    queryFn: () => getRoles(page + 1, searchQuery),\n    keepPreviousData: true,\n    staleTime: 1000 * 60 * 5,\n    retry:1,\n  });\n\n  const debouncedSearch = debounce((value) => {\n    setSearchQuery(value);\n  }, 500);\n\n  const handleSearchChange = (event) => {\n    debouncedSearch(event.target.value);\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = (event) => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleEdit = (role) => {\n    setSelectedRole(role);\n    setEditMode('edit');\n    setIsAddModalOpen(true);\n  };\n\n  const handleAdd = () => {\n    setSelectedRole(null);\n    setEditMode('add');\n    setIsAddModalOpen(true);\n  };\n\n  const handleDelete = async (id) => {\n    try {\n      await Api.delete(`/api/roles/${id}`);\n      refetch();\n      setIsDeleteModalOpen(false);\n      setSelectedRoleId(null);\n    } catch (error) {\n      console.error(\"Error deleting role:\", error);\n    }\n  };\n\n  const openDeleteModal = (roleId) => {\n    setSelectedRoleId(roleId);\n    setIsDeleteModalOpen(true);\n  };\n\n  const getPermissionCount = (permissions) => {\n    if (!permissions) return 0;\n    return permissions.reduce((count, perm) => {\n      const hasPermissions = perm.canView || perm.canAdd || perm.canUpdate || perm.canDelete;\n      return count + (hasPermissions ? 1 : 0);\n    }, 0);\n  };\n\n  return (\n    <Box sx={{ bgcolor: \"#FFFFFF\", minHeight: \"100vh\", display: \"flex\", flexDirection: \"column\" }}>\n      {/* Main Content */}\n      <Box sx={{ p: 5 }}>\n        {/* Search and Add Button */}\n        <Box\n          sx={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            mb: 4,\n            flexWrap: \"wrap\",\n            gap: 2,\n          }}\n        >\n          <TextField\n            placeholder=\"البحث عن دور بالاسم\"\n            variant=\"outlined\"\n            onChange={handleSearchChange}\n            sx={{\n              flex: 1,\n              bgcolor: \"#F3F4F6\",\n              borderRadius: 2,\n              \"& fieldset\": { border: \"none\" },\n            }}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <Search sx={{ color: \"gray\" }} />\n                </InputAdornment>\n              ),\n            }}\n          />\n           {permissions.includes(\"Add\") && (          <Button\n            variant=\"contained\"\n            startIcon={<Add />}\n            onClick={handleAdd}\n            sx={{\n              bgcolor: \"#1E40AF\",\n              \"&:hover\": { bgcolor: \"#1E3A8A\" },\n              fontWeight: \"bold\",\n            }}\n          >\n            إضافة دور جديد\n          </Button>\n          )}\n        </Box>\n\n        {/* Table */}\n        <TableContainer component={Paper} sx={{ borderRadius: 2 }}>\n          <Table stickyHeader>\n            <TableHead sx={{ bgcolor: \"#F3F4F6\" }}>\n              <StyledTableRow>\n                <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>اسم الدور</StyledTableCell>\n                <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>الوصف</StyledTableCell>\n                <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>عدد الصلاحيات</StyledTableCell>\n                <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>تاريخ الإنشاء</StyledTableCell>\n                <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>الإجراءات</StyledTableCell>\n              </StyledTableRow>\n            </TableHead>\n            <TableBody>\n              {isLoading ? (\n                <StyledTableRow>\n                  <StyledTableCell colSpan={5} align=\"center\"><CircularProgress /></StyledTableCell>\n                </StyledTableRow>\n              ) : rolesData?.roles?.map((role) => (\n                <StyledTableRow key={role.id} hover>\n                  <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>\n                    {role.name}\n                  </StyledTableCell>\n                  <StyledTableCell align=\"center\" sx={{ color: \"gray\" }}>\n                    {role.description}\n                  </StyledTableCell>\n                  <StyledTableCell align=\"center\">\n                    <Chip\n                      label={`${getPermissionCount(role.permissions)} صلاحية`}\n                      sx={{\n                        bgcolor: \"rgba(16,185,129,0.1)\",\n                        color: \"#10B981\",\n                        fontWeight:\"bold\",\n                      }}\n                    />\n                  </StyledTableCell>\n                  <StyledTableCell align=\"center\" sx={{ color: \"gray\" }}>\n                    {dayjs(role.createdAt).format(\"DD/MM/YYYY\")}\n                  </StyledTableCell>\n                  <StyledTableCell align=\"center\" sx={{ fontWeight: \"bold\" }}>\n                    {permissions.includes(\"Update\") && (\n                    <IconButton color=\"primary\" onClick={() => handleEdit(role)}>\n                      <Edit />\n                    </IconButton>\n                    )}\n                    {permissions.includes(\"Delete\") && (\n                    <IconButton color=\"error\" onClick={() => openDeleteModal(role.id)}>\n                      <Delete />\n                    </IconButton>\n                    )}\n                  </StyledTableCell>\n                </StyledTableRow>\n              ))}\n            </TableBody>\n          </Table>\n          <TablePagination\n            component=\"div\"\n            count={rolesData?.total || 0}\n            page={page}\n            onPageChange={handleChangePage}\n            rowsPerPage={rowsPerPage}\n            onRowsPerPageChange={handleChangeRowsPerPage}\n            labelRowsPerPage=\"عدد العناصر في الصفحة\"\n          />\n        </TableContainer>\n      </Box>\n\n      <AddRole \n        open={isAddModalOpen}\n        onClose={() => setIsAddModalOpen(false)}\n        refetchRoles={refetch}\n        mode={editMode}\n        editData={selectedRole}\n      />\n      <DeleteModal\n        open={isDeleteModalOpen}\n        onClose={() => setIsDeleteModalOpen(false)}\n        onConfirm={() => handleDelete(selectedRoleId)}\n        title=\"حذف الدور\"\n        message=\"هل أنت متأكد من حذف هذا الدور؟\"\n        ButtonText=\"حذف\"\n      />\n    </Box>\n  );\n}"],"names":["validationSchema","Yup.object","Yup.string","Yup.array","Yup.boolean","availableModules","getAvailableModules","AddRole","open","onClose","refetchRoles","mode","editData","queryClient","useQueryClient","isSubmitting","setIsSubmitting","useState","initialValues","setInitialValues","module","useEffect","formattedPermissions","existingPermission","p","handleSubmit","values","resetForm","payload","Api","notifySuccess","error","notifyError","handlePermissionChange","setFieldValue","moduleIndex","field","value","updatedPermissions","handleSelectAll","permission","jsxs","Dialog","DialogTitle","jsx","IconButton","CloseIcon","Formik","errors","touched","handleChange","handleBlur","Form","DialogContent","Box","TextField","Divider","Typography","action","index","Checkbox","e","moduleConfig","m","FormControlLabel","DialogActions","Button","CircularProgress","getRoles","page","name","Roles","setPage","rowsPerPage","setRowsPerPage","isAddModalOpen","setIsAddModalOpen","editMode","setEditMode","selectedRole","setSelectedRole","isDeleteModalOpen","setIsDeleteModalOpen","selectedRoleId","setSelectedRoleId","searchQuery","setSearchQuery","permissions","usePermissions","rolesData","isLoading","refetch","useQuery","debouncedSearch","debounce","handleSearchChange","event","handleChangePage","newPage","handleChangeRowsPerPage","handleEdit","role","handleAdd","handleDelete","id","openDeleteModal","roleId","getPermissionCount","count","perm","hasPermissions","InputAdornment","Search","Add","TableContainer","Paper","Table","TableHead","StyledTableRow","StyledTableCell","TableBody","Chip","Edit","Delete","TablePagination","DeleteModal"],"mappings":"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"}